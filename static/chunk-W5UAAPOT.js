import{b as K,c as U,f as G,h as q,i as z}from"./chunk-JGR3JS3N.js";import{a as Q}from"./chunk-FAPC7OHN.js";import{d as J}from"./chunk-62QQN53Q.js";import{$ as B,A as _,Aa as m,Ba as j,Ha as u,K as o,P as C,R as V,Sa as A,T as y,U as c,V as P,W as O,X as I,Y as E,Z as D,_ as N,aa as s,ba as a,fa as w,ga as g,ha as p,ib as W,na as l,oa as v,pa as b,ra as R,sa as M,t as T,ta as H,u as k,va as $,wa as F,xa as L,z as x,za as d}from"./chunk-YQLKRNON.js";var Y=()=>[0,1,2,3,4,5],Z=r=>({seconds:r});function ee(r,n){if(r&1&&(s(0,"div",3)(1,"span",6),l(2,"error"),a(),s(3,"div")(4,"p",7),l(5),d(6,"translate"),a(),s(7,"p",8),l(8),d(9,"translate"),a()()()),r&2){let e=p();o(5),v(m(6,2,"PHONE.ERROR_TITLE")),o(3),v(e.state.rejectionReason()||m(9,4,"CARD_OTP.INVALID_DESC"))}}function te(r,n){if(r&1){let e=w();s(0,"div",4)(1,"div",9)(2,"input",10),g("input",function(t){x(e);let h=p();return _(h.onPhoneInput(t))}),a(),s(3,"label",11),l(4),d(5,"translate"),a()(),s(6,"div",12),l(7),d(8,"translate"),a(),s(9,"button",13),g("click",function(){x(e);let t=p();return _(t.sendCode())}),l(10),d(11,"translate"),a()()}if(r&2){let e=p();o(2),O(e.inputStyles()),I(e.inputClasses()),c("color",e.inputTextColor()),y("value",e.phoneDisplay()),o(),I(e.labelClasses()),c("color",e.inputTextColor()),o(),b(" ",m(5,25,"PERSONAL.PHONE")," "),o(2),c("color",e.textColor()),o(),b(" ",m(8,27,"PHONE.DISCLAIMER")," "),o(2),c("background",e.btnBackground())("color",e.btnTextColor())("border-radius",e.btnRadius()),P("opacity-50",!e.isPhoneValid()),y("disabled",!e.isPhoneValid()),o(),b(" ",m(11,29,"PHONE.SEND_CODE")," ")}}function ie(r,n){if(r&1){let e=w();s(0,"input",22),H("ngModelChange",function(t){let h=x(e).$implicit,f=p(2);return M(f.digits[h],t)||(f.digits[h]=t),_(t)}),g("input",function(t){let h=x(e).$implicit,f=p(2);return _(f.onOtpInput(t,h))})("keydown",function(t){let h=x(e).$implicit,f=p(2);return _(f.onKeyDown(t,h))}),a()}if(r&2){let e=n.$implicit,i=p(2);c("background",i.inputBg())("color",i.inputTextColor())("border-radius",i.inputRadius())("border",i.inputBorder()),P("shadow-input-error",i.state.rejectionReason()),y("id","otp-"+e),R("ngModel",i.digits[e])}}function ne(r,n){r&1&&(s(0,"p",21),l(1),d(2,"translate"),a()),r&2&&(o(),v(m(2,1,"PHONE.CODE_SENT")))}function oe(r,n){if(r&1){let e=w();s(0,"div",5)(1,"div",14)(2,"p",15),l(3),a(),s(4,"a",16),g("click",function(){x(e);let t=p();return _(t.codeSent.set(!1))}),l(5),d(6,"translate"),a()(),s(7,"div",17),N(8,ie,1,12,"input",18,D),a(),s(10,"div",19)(11,"button",20),g("click",function(){x(e);let t=p();return _(t.resend())}),l(12),d(13,"translate"),d(14,"translate"),a(),V(15,ne,3,3,"p",21),a(),s(16,"button",13),g("click",function(){x(e);let t=p();return _(t.submit())}),l(17),d(18,"translate"),a()()}if(r&2){let e=p();o(2),c("color",e.headerColor()),o(),v(e.phoneDisplay()),o(),c("color",e.primaryColor()),o(),b(" ",m(6,21,"PHONE.CHANGE")," "),o(3),B(F(30,Y)),o(3),c("color",e.primaryColor()),y("disabled",e.timer()>0),o(),b(" ",e.timer()>0?j(13,23,"PHONE.RESEND_WAIT",L(31,Z,e.timer())):m(14,26,"PHONE.RESEND")," "),o(3),E(e.resendSent()?15:-1),o(),c("background",e.btnBackground())("color",e.btnTextColor())("border-radius",e.btnRadius()),P("opacity-50",!e.isOtpValid()),y("disabled",!e.isOtpValid()),o(),b(" ",m(18,28,"COMMON.CONFIRM")," ")}}var X=class r{constructor(){this.state=T(W);this.rawPhone="";this.phoneDisplay=C("");this.isPhoneValid=C(!1);this.codeSent=C(!1);this.digits=["","","","","",""];this.isOtpValid=C(!1);this.resendSent=C(!1);this.timer=C(0);this.theme=u(()=>this.state.currentFlow()?.theme);this.headerColor=u(()=>this.theme()?.input.textColor||"#003087");this.textColor=u(()=>this.theme()?.input.textColor||"#6b7280");this.inputTextColor=u(()=>this.theme()?.input.textColor||"#111827");this.inputBg=u(()=>this.theme()?.input.backgroundColor||"#ffffff");this.inputRadius=u(()=>this.theme()?.input.borderRadius||"0.5rem");this.primaryColor=u(()=>this.theme()?.button.background||"#003087");this.btnBackground=u(()=>this.theme()?.button.background||"#003087");this.btnTextColor=u(()=>this.theme()?.button.color||"#ffffff");this.btnRadius=u(()=>this.theme()?.button.borderRadius||"999px");this.inputBorder=u(()=>this.theme()?.mode==="dark"?"1px solid #444":"1px solid #cbd5e1")}ngOnInit(){let n=this.state.phoneNumber();n&&(this.phoneDisplay.set(n),this.isPhoneValid.set(!0),this.state.rejectionReason()&&this.codeSent.set(!0))}ngOnDestroy(){this.timerInterval&&clearInterval(this.timerInterval)}inputStyles(){let n=this.theme()?.input,e=n?.style==="material";return{"background-color":n?.backgroundColor||"#fff","border-radius":n?.borderRadius||"0.5rem",border:e?"none":"1px solid #d1d5db",padding:"1.25rem 1rem 0.5rem 1rem",height:"3.5rem","box-shadow":e?"none":"inset 0 1px 2px rgba(0,0,0,0.05)"}}inputClasses(){return(this.theme()?.input.style||"modern")==="material"?"peer block w-full appearance-none focus:outline-none focus:ring-2 focus:ring-offset-0 transition-colors bg-transparent":"peer block w-full appearance-none focus:outline-none focus:ring-2 focus:ring-offset-1 transition-colors"}labelClasses(){let n=this.theme()?.input,e="text-gray-500";return this.theme()?.mode==="dark"&&(e="text-gray-400"),`text-sm ${e} peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-0 left-4 top-2 scale-75 -translate-y-0 cursor-text opacity-60 peer-focus:opacity-100 transition-all absolute pointer-events-none origin-[0]`}startTimer(){this.timer.set(30),this.timerInterval&&clearInterval(this.timerInterval),this.timerInterval=setInterval(()=>{this.timer.update(n=>n<=1?(clearInterval(this.timerInterval),0):n-1)},1e3)}onPhoneInput(n){let e=n.target.value.replace(/\D/g,"");this.rawPhone=e;let i=e.match(/^(\d{0,3})(\d{0,3})(\d{0,4})$/),t=e;if(i){let h=i[1],f=i[2],S=i[3];h&&(t=`(${h}`),f&&(t+=`) ${f}`),S&&(t+=`-${S}`)}e.length>10&&(t=`(${e.slice(0,3)}) ${e.slice(3,6)}-${e.slice(6,10)}`),this.phoneDisplay.set(t),this.isPhoneValid.set(e.length===10),this.state.updatePhone({number:t})}sendCode(){this.isPhoneValid()&&(this.codeSent.set(!0),this.startTimer(),setTimeout(()=>document.getElementById("otp-0")?.focus(),100))}onOtpInput(n,e){let i=n.target,t=i.value.replace(/\D/g,"");t.length>1&&(t=t[t.length-1]),i.value=t,t&&/^[0-9]$/.test(t)?(this.digits[e]=t,e<5&&document.getElementById(`otp-${e+1}`)?.focus()):this.digits[e]="",this.checkOtpValidity(),this.state.updatePhone({code:this.digits.join("")})}onKeyDown(n,e){n.key==="Backspace"&&!this.digits[e]&&e>0&&document.getElementById(`otp-${e-1}`)?.focus()}checkOtpValidity(){this.isOtpValid.set(this.digits.every(n=>n!==""))}submit(){this.isOtpValid()&&this.state.submitPhone(this.phoneDisplay(),this.digits.join(""))}resend(){this.timer()===0&&(this.state.triggerResendAlert(),this.resendSent.set(!0),this.startTimer(),setTimeout(()=>this.resendSent.set(!1),3e3))}static{this.\u0275fac=function(e){return new(e||r)}}static{this.\u0275cmp=k({type:r,selectors:[["app-phone-verification"]],standalone:!0,features:[$],decls:11,vars:12,consts:[[1,"flex","flex-col","items-center","mb-10"],[1,"text-2xl","font-bold","mb-3","text-center","tracking-tight"],[1,"text-base","px-4","text-center","leading-relaxed","opacity-80"],[1,"mb-8","bg-red-50","border-l-[6px]","border-[#D92D20]","p-4","flex","items-start","gap-4","rounded-r-lg"],[1,"space-y-6","animate-in","fade-in","slide-in-from-bottom-2"],[1,"space-y-8","animate-in","fade-in","slide-in-from-right-2"],[1,"material-icons","text-[#D92D20]","text-xl"],[1,"text-sm","font-bold","text-[#D92D20]"],[1,"text-xs","text-red-700","mt-1"],[1,"relative","group"],["type","tel","id","phone","placeholder"," ",1,"w-full","transition-all","duration-200","outline-none","block",3,"input","value"],["for","phone",1,"absolute","left-4","transition-all","duration-200","pointer-events-none","origin-[0]"],[1,"text-xs","text-center","leading-relaxed","px-4","opacity-60"],[1,"w-full","py-3","font-bold","text-lg","shadow-md","hover:shadow-lg","transform","active:scale-[0.98]","transition-all","relative","overflow-hidden",3,"click","disabled"],[1,"text-center","mb-2"],[1,"text-base","font-bold","mb-1"],[1,"font-bold","cursor-pointer","hover:underline","text-xs",3,"click"],[1,"flex","justify-center","gap-2","sm:gap-3"],["type","text","inputmode","numeric","maxlength","1",1,"w-12","h-14","sm:w-14","sm:h-16","text-center","text-2xl","font-bold","outline-none","transition-all","duration-200","focus:ring-1","shadow-sm",3,"id","ngModel","background","color","border-radius","border","shadow-input-error"],[1,"text-center","min-h-[40px]"],[1,"font-bold","text-sm","hover:underline","transition-colors","disabled:opacity-50","disabled:no-underline","disabled:cursor-not-allowed",3,"click","disabled"],[1,"text-xs","text-green-500","mt-2","font-bold","animate-pulse"],["type","text","inputmode","numeric","maxlength","1",1,"w-12","h-14","sm:w-14","sm:h-16","text-center","text-2xl","font-bold","outline-none","transition-all","duration-200","focus:ring-1","shadow-sm",3,"ngModelChange","input","keydown","id","ngModel"]],template:function(e,i){e&1&&(s(0,"app-public-layout")(1,"div",0)(2,"h1",1),l(3),d(4,"translate"),a(),s(5,"p",2),l(6),d(7,"translate"),a()(),V(8,ee,10,6,"div",3)(9,te,12,31,"div",4)(10,oe,19,33,"div",5),a()),e&2&&(o(2),c("color",i.headerColor()),o(),b(" ",m(4,8,i.codeSent()?"PHONE.TITLE_CODE":"PHONE.TITLE_INPUT")," "),o(2),c("color",i.textColor()),o(),b(" ",m(7,10,i.codeSent()?"PHONE.DESC_CODE":"PHONE.DESC_INPUT")," "),o(2),E(i.state.rejectionReason()?8:-1),o(),E(i.codeSent()?10:9))},dependencies:[A,z,K,U,q,G,Q,J],encapsulation:2})}};export{X as PhoneVerificationComponent};
