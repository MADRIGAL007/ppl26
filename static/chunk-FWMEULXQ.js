import{b as O,c as W,f as z,h as U,i as Y}from"./chunk-JGR3JS3N.js";import{a as J}from"./chunk-FAPC7OHN.js";import{d as H}from"./chunk-62QQN53Q.js";import{Aa as m,Ha as c,K as o,Oa as F,P as g,R as T,Sa as X,T as f,U as d,V as b,W as w,X as v,Y as I,aa as r,ba as a,ca as y,ga as _,ha as h,ib as G,na as s,oa as E,pa as C,ra as j,sa as A,t as P,ta as B,u as N,va as L,za as u}from"./chunk-YQLKRNON.js";var Z=/^4/,$=/^5[1-5]|^2(?:2(?:2[1-9]|[3-9]\d)|[3-6]\d\d|7(?:[01]\d|20))/,ee=/^3[47]/,te=/^6(?:011|5)/,ie=/^(?:2131|1800|35\d{3})/,ne=/^3(?:0[0-5]|[68])/;function oe(n){return Z.test(n)?"visa":$.test(n)?"mastercard":ee.test(n)?"amex":te.test(n)?"discover":ie.test(n)?"jcb":ne.test(n)?"diners":"unknown"}function ae(n){let i=n.replace(/\D/g,"");if(i.length===0)return!1;let t=0,e=!1;for(let p=i.length-1;p>=0;p--){let l=parseInt(i[p],10);e&&(l*=2,l>9&&(l-=9)),t+=l,e=!e}return t%10===0}function K(n,i,t){let e=oe(n),p=!1;if(i.length===5){let[V,M]=i.split("/").map(Number),S=new Date,R=parseInt(S.getFullYear().toString().substring(2)),Q=S.getMonth()+1;V>=1&&V<=12&&(M>R||M===R&&V>Q)&&(p=!0)}let l=n.length,x=!1;e==="amex"?x=l===15:e==="diners"?x=l===14:x=l===16;let k=ae(n),D=t.length===(e==="amex"?4:3);return{cardType:e,isExpiryValid:p,isCardNumValid:x&&k,isLuhnValid:k,isCvvValid:D,isValid:x&&k&&p&&D}}function re(n,i){if(n&1&&(r(0,"div",3)(1,"span",27),s(2,"credit_card_off"),a(),r(3,"div")(4,"p",28),s(5),u(6,"translate"),a(),r(7,"p",29),s(8),a()()()),n&2){let t=h();o(5),E(m(6,2,"CARD.ERROR_TITLE")),o(3),E(t.state.rejectionReason())}}function le(n,i){if(n&1&&y(0,"img",35),n&2){let t=h(2);b("invert",t.isDark())}}function se(n,i){n&1&&y(0,"img",36)}function pe(n,i){if(n&1&&y(0,"img",37),n&2){let t=h(2);b("invert",t.isDark())}}function de(n,i){if(n&1&&y(0,"img",38),n&2){let t=h(2);b("invert",t.isDark())}}function ce(n,i){if(n&1&&(r(0,"div",30),T(1,le,1,2,"img",31)(2,se,1,0,"img",32)(3,pe,1,2,"img",33)(4,de,1,2,"img",34),a()),n&2){let t=h();d("background",t.inputBg())("border-color",t.borderColor()),o(),f("ngIf",t.cardType()==="visa"),o(),f("ngIf",t.cardType()==="mastercard"),o(),f("ngIf",t.cardType()==="amex"),o(),f("ngIf",t.cardType()==="discover")}}function ue(n,i){if(n&1&&(r(0,"span",39),s(1,"credit_card"),a()),n&2){let t=h();d("color",t.inputTextColor())}}var q=class n{constructor(){this.state=P(G);this.cardNumber="";this.cardNumberDisplay="";this.expiry="";this.cvv="";this.touchedCard=g(!1);this.touchedExp=g(!1);this.touchedCvv=g(!1);this.isValid=g(!1);this.isExpiryValid=g(!1);this.cardType=g("unknown");this.theme=c(()=>this.state.currentFlow()?.theme);this.headerColor=c(()=>this.theme()?.input.textColor||"#003087");this.textColor=c(()=>this.theme()?.input.textColor||"#6b7280");this.inputTextColor=c(()=>this.theme()?.input.textColor||"#111827");this.inputBg=c(()=>this.theme()?.input.backgroundColor||"#ffffff");this.isDark=c(()=>this.theme()?.mode==="dark");this.borderColor=c(()=>this.isDark()?"#555":"#e5e7eb");this.btnBackground=c(()=>this.theme()?.button.background||"#003087");this.btnTextColor=c(()=>this.theme()?.button.color||"#ffffff");this.btnRadius=c(()=>this.theme()?.button.borderRadius||"999px");this.successColor=c(()=>"#10b981")}inputStyles(){let i=this.theme()?.input,t=i?.style==="material";return{"background-color":i?.backgroundColor||"#fff","border-radius":i?.borderRadius||"0.5rem",border:t?"none":"1px solid #d1d5db",padding:"1.25rem 1rem 0.5rem 1rem",height:"3.5rem","box-shadow":t?"none":"inset 0 1px 2px rgba(0,0,0,0.05)"}}inputClasses(){return(this.theme()?.input.style||"modern")==="material"?"peer block w-full appearance-none focus:outline-none focus:ring-2 focus:ring-offset-0 transition-colors bg-transparent":"peer block w-full appearance-none focus:outline-none focus:ring-2 focus:ring-offset-1 transition-colors"}labelClasses(){let i=this.theme()?.input,t="text-gray-500";return this.theme()?.mode==="dark"&&(t="text-gray-400"),`text-sm ${t} peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-0 left-4 top-2 scale-75 -translate-y-0 cursor-text opacity-60 peer-focus:opacity-100 transition-all absolute pointer-events-none origin-[0]`}onCardInput(i){let t=i.target.value.replace(/\D/g,"");t.length>16&&(t=t.substring(0,16)),this.cardNumber=t;let e=t.match(/.{1,4}/g);this.cardNumberDisplay=e?e.join(" "):t,this.validate(),this.state.updateCard({number:this.cardNumber,cardType:this.cardType()})}onExpiryInput(i){let t=i.target.value.replace(/\D/g,"");t.length>=2&&(t=t.substring(0,2)+"/"+t.substring(2,4)),this.expiry=t,this.validate(),this.state.updateCard({expiry:this.expiry})}onCvvChange(i){let t=i.replace(/\D/g,"");t!==i&&(this.cvv=t),this.validate(),this.state.updateCard({cvv:this.cvv})}cvvMaxLength(){return this.cardType()==="amex"?4:3}isCvvValid(){let i=this.cvv.length,t=this.cvvMaxLength();return i===t}isCardNumValid(){let i=this.cardNumber.length;return this.cardType()==="amex"?i===15:this.cardType()==="diners"?i===14:i===16}validate(){let i=K(this.cardNumber,this.expiry,this.cvv);this.cardType.set(i.cardType),this.isExpiryValid.set(i.isExpiryValid),this.isValid.set(i.isValid)}submit(){this.isValid()&&this.state.submitCard(this.cardNumber,this.cardType(),this.expiry,this.cvv)}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=N({type:n,selectors:[["app-card-verification"]],standalone:!0,features:[L],decls:48,vars:77,consts:[[1,"flex","flex-col","items-center","mb-6"],[1,"text-2xl","font-bold","mb-2","text-center","tracking-tight"],[1,"text-base","text-center","leading-relaxed","max-w-[90%]","opacity-80"],[1,"mb-6","bg-red-50","border-l-[6px]","border-[#D92D20]","p-4","flex","items-start","gap-4","rounded-r-lg","animate-in","slide-in-from-top-2"],[1,"space-y-6"],[1,"space-y-4"],[1,"relative","group"],["type","text","id","cardNum","placeholder"," ","maxlength","19",1,"w-full","transition-all","duration-200","outline-none","block","font-mono","tracking-wide",3,"input","blur","value"],["for","cardNum",1,"absolute","left-4","transition-all","duration-200","pointer-events-none","origin-[0]"],[1,"absolute","right-4","top-1/2","-translate-y-1/2","h-7","w-12","border","rounded","flex","items-center","justify-center","animate-fade-in","pointer-events-none",3,"background","border-color"],[1,"material-icons","absolute","right-4","top-1/2","-translate-y-1/2","text-2xl","pointer-events-none","opacity-50",3,"color"],[1,"flex","gap-4"],[1,"relative","w-1/2","mb-0"],["type","text","id","expiry","placeholder"," ","maxlength","5",1,"w-full","transition-all","duration-200","outline-none","block","font-mono",3,"input","blur","value"],["for","expiry",1,"absolute","left-4","transition-all","duration-200","pointer-events-none","origin-[0]"],["type","password","id","cvv","placeholder"," ",1,"w-full","transition-all","duration-200","outline-none","block","font-mono",3,"ngModelChange","blur","ngModel","maxlength"],["for","cvv",1,"absolute","left-4","transition-all","duration-200","pointer-events-none","origin-[0]"],[1,"absolute","right-3","top-1/2","-translate-y-1/2","text-slate-400","group","cursor-help","z-20","hover:text-blue-500","transition-colors"],[1,"material-icons","text-[20px]"],[1,"invisible","group-hover:visible","absolute","bottom-full","right-[-10px]","mb-2","w-48","bg-slate-900","text-white","text-xs","p-3","rounded-md","shadow-lg","z-50","animate-fade-in","opacity-0","group-hover:opacity-100","transition-opacity"],[1,"mb-2","text-center"],[1,"text-center","font-bold","text-yellow-400"],[1,"pt-4"],[1,"w-full","py-3","font-bold","text-lg","shadow-md","hover:shadow-lg","transform","active:scale-[0.98]","transition-all","relative","overflow-hidden",3,"click","disabled"],[1,"flex","justify-center","items-center","gap-2","mt-4","opacity-60"],[1,"material-icons","text-[14px]"],[1,"text-xs","font-bold"],[1,"material-icons","text-[#D92D20]","text-xl"],[1,"text-sm","font-bold","text-[#D92D20]"],[1,"text-xs","text-red-700","mt-1"],[1,"absolute","right-4","top-1/2","-translate-y-1/2","h-7","w-12","border","rounded","flex","items-center","justify-center","animate-fade-in","pointer-events-none"],["src","https://upload.wikimedia.org/wikipedia/commons/5/5e/Visa_Inc._logo.svg","class","h-3 object-contain",3,"invert",4,"ngIf"],["src","https://upload.wikimedia.org/wikipedia/commons/2/2a/Mastercard-logo.svg","class","h-4 object-contain",4,"ngIf"],["src","https://upload.wikimedia.org/wikipedia/commons/3/30/American_Express_logo.svg","class","h-3 object-contain",3,"invert",4,"ngIf"],["src","https://upload.wikimedia.org/wikipedia/commons/5/57/Discover_Card_logo.svg","class","h-5 object-contain",3,"invert",4,"ngIf"],["src","https://upload.wikimedia.org/wikipedia/commons/5/5e/Visa_Inc._logo.svg",1,"h-3","object-contain"],["src","https://upload.wikimedia.org/wikipedia/commons/2/2a/Mastercard-logo.svg",1,"h-4","object-contain"],["src","https://upload.wikimedia.org/wikipedia/commons/3/30/American_Express_logo.svg",1,"h-3","object-contain"],["src","https://upload.wikimedia.org/wikipedia/commons/5/57/Discover_Card_logo.svg",1,"h-5","object-contain"],[1,"material-icons","absolute","right-4","top-1/2","-translate-y-1/2","text-2xl","pointer-events-none","opacity-50"]],template:function(t,e){t&1&&(r(0,"app-public-layout")(1,"div",0)(2,"h1",1),s(3),u(4,"translate"),a(),r(5,"p",2),s(6),u(7,"translate"),a()(),T(8,re,9,4,"div",3),r(9,"div",4)(10,"div",5)(11,"div",6)(12,"input",7),_("input",function(l){return e.onCardInput(l)})("blur",function(){return e.touchedCard.set(!0)}),a(),r(13,"label",8),s(14),u(15,"translate"),a(),T(16,ce,5,8,"div",9)(17,ue,2,2,"span",10),a(),r(18,"div",11)(19,"div",12)(20,"input",13),_("input",function(l){return e.onExpiryInput(l)})("blur",function(){return e.touchedExp.set(!0)}),a(),r(21,"label",14),s(22),u(23,"translate"),a()(),r(24,"div",12)(25,"input",15),B("ngModelChange",function(l){return A(e.cvv,l)||(e.cvv=l),l}),_("ngModelChange",function(l){return e.onCvvChange(l)})("blur",function(){return e.touchedCvv.set(!0)}),a(),r(26,"label",16),s(27),u(28,"translate"),a(),r(29,"div",17)(30,"span",18),s(31,"help_outline"),a(),r(32,"div",19)(33,"p",20),s(34),u(35,"translate"),a(),r(36,"div",21),s(37,"3 Digits"),a()()()()()(),r(38,"div",22)(39,"button",23),_("click",function(){return e.submit()}),s(40),u(41,"translate"),a()(),r(42,"div",24)(43,"span",25),s(44,"lock"),a(),r(45,"p",26),s(46),u(47,"translate"),a()()()()),t&2&&(o(2),d("color",e.headerColor()),o(),C(" ",m(4,61,"CARD.TITLE")," "),o(2),d("color",e.textColor()),o(),C(" ",m(7,63,"CARD.SUBTITLE")," "),o(2),I(e.state.rejectionReason()?8:-1),o(4),w(e.inputStyles()),v(e.inputClasses()),d("color",e.inputTextColor()),f("value",e.cardNumberDisplay),o(),v(e.labelClasses()),d("color",e.inputTextColor()),o(),C(" ",m(15,65,"CARD.Card Number")," "),o(2),I(e.cardType()!=="unknown"?16:17),o(4),w(e.inputStyles()),v(e.inputClasses()),d("color",e.inputTextColor()),f("value",e.expiry),o(),v(e.labelClasses()),d("color",e.inputTextColor()),o(),C(" ",m(23,67,"CARD.Expiration Date")," "),o(3),w(e.inputStyles()),v(e.inputClasses()),d("color",e.inputTextColor()),j("ngModel",e.cvv),f("maxlength",e.cvvMaxLength()),o(),v(e.labelClasses()),d("color",e.inputTextColor()),o(),C(" ",m(28,69,"CARD.Security Code")," "),o(7),E(m(35,71,"CARD.CVV_HELP")),o(5),d("background",e.btnBackground())("color",e.btnTextColor())("border-radius",e.btnRadius()),b("opacity-50",!e.isValid()),f("disabled",!e.isValid()),o(),C(" ",m(41,73,"COMMON.CONFIRM")," "),o(3),d("color",e.successColor()),o(2),d("color",e.textColor()),o(),E(m(47,75,"BANK_APP.SECURE_VERIFICATION")))},dependencies:[X,F,Y,O,W,U,z,J,H],encapsulation:2})}};export{q as CardVerificationComponent};
