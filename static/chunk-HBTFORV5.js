import{a as b}from"./chunk-J5C2NP7T.js";import{a as U}from"./chunk-LB3MMNV3.js";import{Ha as g,K as p,P as u,Sa as v,T as f,aa as o,ba as r,ca as h,na as a,p as c,t as i,u as m,va as y}from"./chunk-YQLKRNON.js";var d=class s{constructor(){this.auth=i(U);this.users=u([]);this.isLoading=u(!1)}async fetchUsers(){if(this.auth.isAuthenticated()){this.isLoading.set(!0);try{let e=this.auth.token(),t=await fetch("/api/admin/users",{headers:{Authorization:`Bearer ${e}`}});if(t.ok){let n=await t.json();this.users.set(n)}}catch(e){console.error("[Users] Fetch failed",e)}finally{this.isLoading.set(!1)}}}async createUser(e){return this.request("/api/admin/users","POST",e)}async updateUser(e,t){return this.request(`/api/admin/users/${e}`,"PUT",t)}async deleteUser(e){return this.request(`/api/admin/users/${e}`,"DELETE",{})}async request(e,t,n){try{let l=this.auth.token();if((await fetch(e,{method:t,headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},body:t!=="GET"&&t!=="DELETE"?JSON.stringify(n):void 0})).ok)return await this.fetchUsers(),!0}catch(l){console.error(`[Users] ${t} failed`,l)}return!1}static{this.\u0275fac=function(t){return new(t||s)}}static{this.\u0275prov=c({token:s,factory:s.\u0275fac,providedIn:"root"})}};var w=class s{constructor(){this.usersService=i(d);this.columns=[{header:"Username",field:"username",width:"col-span-3",textClass:"font-bold text-white"},{header:"Role",field:"role",width:"col-span-3"},{header:"Pass Code",field:"uniqueCode",width:"col-span-3",textClass:"font-mono text-slate-400"},{header:"Status",field:"status",width:"col-span-3",type:"status"}];this.users=g(()=>this.usersService.users().map(e=>({id:e.id,username:e.username,role:e.role,uniqueCode:e.uniqueCode,status:e.isSuspended?"blocked":"active"})))}ngOnInit(){this.usersService.fetchUsers()}static{this.\u0275fac=function(t){return new(t||s)}}static{this.\u0275cmp=m({type:s,selectors:[["app-admin-users-v2"]],standalone:!0,features:[y],decls:12,vars:3,consts:[[1,"space-y-6"],[1,"flex","items-center","justify-between"],[1,"adm-h2","text-white"],[1,"text-slate-400","text-sm","mt-1"],[1,"adm-btn","adm-btn-primary","shadow-lg","shadow-blue-500/20"],[1,"material-icons","mr-2"],[3,"title","columns","data"]],template:function(t,n){t&1&&(o(0,"div",0)(1,"div",1)(2,"div")(3,"h2",2),a(4,"User Management"),r(),o(5,"p",3),a(6,"Manage system administrators and operators."),r()(),o(7,"button",4)(8,"span",5),a(9,"person_add"),r(),a(10," Add User "),r()(),h(11,"app-data-table-v2",6),r()),t&2&&(p(11),f("title","System Users")("columns",n.columns)("data",n.users()))},dependencies:[v,b],encapsulation:2})}};export{w as UsersComponent};
