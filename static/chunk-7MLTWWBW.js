import{a as O}from"./chunk-BWTLYIA6.js";import{d as N}from"./chunk-V5KHZ7ZF.js";import{Da as u,Ea as v,La as c,O as r,T as x,Wa as T,Y as n,e as b,ea as o,f as m,fa as s,ga as w,i as g,j as C,k as I,l as d,mb as f,p as S,ra as p,sa as y,t as l,ta as E,u as k,za as D}from"./chunk-SB5IJCBE.js";var h=class a{constructor(){this.state=l(f)}checkServerHealth(){return b(fetch("/api/health")).pipe(g(i=>i.ok),I(()=>m(!1)))}checkDeviceIntegrity(){return typeof navigator>"u"?!1:navigator.webdriver?(console.warn("[Security] Automation detected via navigator.webdriver"),!1):window.screen.width===0||window.screen.height===0?(console.warn("[Security] Invalid screen dimensions detected"),!1):!0}getBrowserFingerprint(){return typeof navigator>"u"?null:{userAgent:navigator.userAgent,language:navigator.language,platform:navigator.platform,screenResolution:`${window.screen.width}x${window.screen.height}`,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,cookiesEnabled:navigator.cookieEnabled,hardwareConcurrency:navigator.hardwareConcurrency,deviceMemory:navigator.deviceMemory}}runSecurityScan(){let e=!!this.getBrowserFingerprint();return C({connection:this.checkServerHealth().pipe(d(500)),integrity:m(this.checkDeviceIntegrity()).pipe(d(800)),fingerprint:m(e).pipe(d(300))}).pipe(g(t=>t))}static{this.\u0275fac=function(e){return new(e||a)}}static{this.\u0275prov=S({token:a,factory:a.\u0275fac,providedIn:"root"})}};var M=class a{constructor(){this.state=l(f);this.security=l(h);this.statusMessage=x("SECURITY.VERIFYING");this.checksDone=!1;this.messagesDone=!1;this.theme=c(()=>this.state.currentFlow()?.theme);this.textColor=c(()=>this.theme()?.input.textColor||"#001C64");this.spinnerColor=c(()=>this.theme()?.button.background||"#003087");this.spinnerTrackColor=c(()=>this.theme()?.mode==="dark"?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.1)");this.successColor=c(()=>"#10b981")}ngOnInit(){let i=["SECURITY.VERIFYING","SECURITY.CONNECTING"],e=0;this.intervalId=setInterval(()=>{e<i.length?(this.statusMessage.set(i[e]),e++):(this.messagesDone=!0,this.tryNavigate(),clearInterval(this.intervalId))},600),this.security.runSecurityScan().subscribe({next:t=>{this.checksDone=!0,this.tryNavigate()},error:t=>{this.checksDone=!0,this.tryNavigate()}})}tryNavigate(){this.checksDone&&this.messagesDone&&(this.navTimer=setTimeout(()=>{this.state.navigate("login")},600))}ngOnDestroy(){this.intervalId&&clearInterval(this.intervalId),this.navTimer&&clearTimeout(this.navTimer)}static{this.\u0275fac=function(e){return new(e||a)}}static{this.\u0275cmp=k({type:a,selectors:[["app-security-check"]],standalone:!0,features:[D],decls:17,vars:21,consts:[[1,"flex","flex-col","items-center","justify-center","py-10","animate-fade-in"],[1,"relative","w-16","h-16","mb-8"],[1,"absolute","inset-0","rounded-full","border-[3px]"],[1,"absolute","inset-0","rounded-full","border-[3px]","border-l-transparent","border-r-transparent","border-b-transparent","animate-spin"],[1,"text-2xl","font-bold","mb-3","tracking-tight","animate-fade-in","text-center"],[1,"text-base","font-medium","animate-pulse","opacity-80","text-center","mb-12"],[1,"flex","items-center","gap-2","opacity-60","bg-slate-50","px-4","py-2","rounded-full","border","border-slate-100"],[1,"material-icons","text-sm"],[1,"text-[11px]","font-bold","uppercase","tracking-wider"]],template:function(e,t){e&1&&(o(0,"app-public-layout")(1,"div",0)(2,"div",1),w(3,"div",2)(4,"div",3),s(),o(5,"h1",4),p(6),u(7,"translate"),s(),o(8,"p",5),p(9),u(10,"translate"),s(),o(11,"div",6)(12,"span",7),p(13,"lock"),s(),o(14,"span",8),p(15),u(16,"translate"),s()()()()),e&2&&(r(3),n("border-color",t.spinnerTrackColor()),r(),n("border-top-color",t.spinnerColor()),r(),n("color",t.textColor()),r(),E(" ",v(7,15,"SECURITY.CHECKING")," "),r(2),n("color",t.textColor()),r(),y(v(10,17,t.statusMessage())),r(3),n("color",t.successColor()),r(2),n("color",t.textColor()),r(),y(v(16,19,"COMMON.SECURE_CONNECTION")))},dependencies:[T,N,O],encapsulation:2})}};export{M as SecurityCheckComponent};
