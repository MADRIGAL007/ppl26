import{a as A}from"./chunk-KPUWXNA5.js";import{a as I}from"./chunk-KZPLNQ7B.js";import{c as G,d as N,g as F,o as D}from"./chunk-IHFM4ZIH.js";import{A as p,Ba as E,Ga as M,Ha as k,O as m,Oa as P,T as w,Ta as U,Ua as V,V as v,X as g,Xa as B,Za as W,aa as h,ea as i,fa as t,ga as f,ka as b,la as u,ma as l,t as S,ta as a,u as y,va as T,xa as _,ya as x,z as c,za as C}from"./chunk-OJFOISDS.js";function O(s,d){if(s&1){let e=b();i(0,"button",7),u("click",function(){let n=c(e).$implicit,r=l();return p(r.activeTab.set(n.id))}),a(1),t()}if(s&2){let e=d.$implicit,o=l();g("ngClass",o.activeTab()===e.id?"border-blue-500 text-blue-400":"border-transparent text-slate-400 hover:text-slate-200"),m(),T(" ",e.label," ")}}function L(s,d){if(s&1&&(i(0,"div",5)(1,"h3",8),a(2,"Profile Details"),t(),i(3,"div",9)(4,"div",10)(5,"label",11),a(6,"Username"),t(),f(7,"input",12),t(),i(8,"div",10)(9,"label",11),a(10,"Role"),t(),f(11,"input",12),M(12,"uppercase"),t()(),i(13,"div",13)(14,"h4",14),a(15,"Change Password"),t(),i(16,"div",15),f(17,"input",16)(18,"input",17),i(19,"button",18),a(20,"Update Password"),t()()()()),s&2){let e,o,n=l();m(7),g("value",(e=n.currentUser())==null?null:e.username),m(4),g("value",k(12,2,(o=n.currentUser())==null?null:o.role))}}function j(s,d){if(s&1){let e=b();i(0,"div",5)(1,"h3",8),a(2,"Telegram Alerts"),t(),i(3,"p",19),a(4,"Configure where you want to receive notifications for new sessions and completed flows."),t(),i(5,"div",15)(6,"div",10)(7,"label",11),a(8,"Bot Token"),t(),i(9,"div",20)(10,"input",21),C("ngModelChange",function(n){c(e);let r=l();return x(r.tgToken,n)||(r.tgToken=n),p(n)}),t(),i(11,"button",22),u("click",function(){c(e);let n=l();return p(n.saveTg())}),a(12,"Save"),t()()(),i(13,"div",10)(14,"label",11),a(15,"Chat ID"),t(),i(16,"div",20)(17,"input",23),C("ngModelChange",function(n){c(e);let r=l();return x(r.tgChat,n)||(r.tgChat=n),p(n)}),t(),i(18,"button",22),u("click",function(){c(e);let n=l();return p(n.saveTg())}),a(19,"Save"),t()()()()()}if(s&2){let e=l();m(10),_("ngModel",e.tgToken),m(7),_("ngModel",e.tgChat)}}function q(s,d){if(s&1){let e=b();i(0,"div",6)(1,"div",24)(2,"span",25),a(3,"security"),t(),i(4,"h3",8),a(5,"Global Gate Access"),t()(),i(6,"p",19),a(7,"Credentials required for visitors to access the verification site (HTTP Basic Auth or Gate Page)."),t(),i(8,"div",9)(9,"div",10)(10,"label",11),a(11,"Gate User"),t(),i(12,"input",26),C("ngModelChange",function(n){c(e);let r=l();return x(r.gateUser,n)||(r.gateUser=n),p(n)}),t()(),i(13,"div",10)(14,"label",11),a(15,"Gate Password"),t(),i(16,"input",26),C("ngModelChange",function(n){c(e);let r=l();return x(r.gatePass,n)||(r.gatePass=n),p(n)}),t()()(),i(17,"div",27)(18,"button",28),u("click",function(){c(e);let n=l();return p(n.saveGate())}),a(19,"Update Gate Credentials"),t()()()}if(s&2){let e=l();m(12),_("ngModel",e.gateUser),m(4),_("ngModel",e.gatePass)}}var H=class s{constructor(){this.auth=S(I);this.settings=S(A);this.activeTab=w("profile");this.currentUser=this.auth.currentUser;this.isHypervisor=P(()=>this.currentUser()?.role==="hypervisor");this.tgToken="";this.tgChat="";this.gateUser="";this.gatePass=""}get tabs(){let d=[{id:"profile",label:"Profile"},{id:"notifications",label:"Notifications"}];return this.isHypervisor()&&d.push({id:"security",label:"Security"}),d}ngOnInit(){this.settings.fetchSettings().then(()=>{this.syncModels()})}syncModels(){let d=this.settings.userSettings(),e=this.settings.systemSettings();this.tgToken=d.telegramBotToken||"",this.tgChat=d.telegramChatId||"",this.isHypervisor()&&(this.gateUser=e.gateUser||"",this.gatePass=e.gatePass||"",!this.tgToken&&e.telegramBotToken&&(this.tgToken=e.telegramBotToken),!this.tgChat&&e.telegramChatId&&(this.tgChat=e.telegramChatId))}async saveTg(){await this.settings.updateUserSetting("telegramBotToken",this.tgToken),await this.settings.updateUserSetting("telegramChatId",this.tgChat),alert("Notification settings saved.")}async saveGate(){this.isHypervisor()&&(await this.settings.updateSystemSetting("gateUser",this.gateUser),await this.settings.updateSystemSetting("gatePass",this.gatePass),alert("Gate credentials updated."))}static{this.\u0275fac=function(e){return new(e||s)}}static{this.\u0275cmp=y({type:s,selectors:[["app-admin-settings-v2"]],standalone:!0,features:[E],decls:11,vars:4,consts:[[1,"space-y-8"],[1,"adm-h2","text-white"],[1,"text-slate-400","text-sm","mt-1"],[1,"flex","border-b","border-slate-800"],["class","px-6 py-3 text-sm font-medium transition-colors border-b-2",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"adm-card","space-y-6","max-w-2xl"],[1,"adm-card","space-y-6","max-w-2xl","border-orange-500/20"],[1,"px-6","py-3","text-sm","font-medium","transition-colors","border-b-2",3,"click","ngClass"],[1,"text-white","font-bold"],[1,"grid","grid-cols-2","gap-4"],[1,"space-y-1"],[1,"text-xs","font-bold","text-slate-500","uppercase"],["type","text","disabled","",1,"adm-input","opacity-50","cursor-not-allowed",3,"value"],[1,"pt-4","border-t","border-slate-800"],[1,"text-white","text-sm","font-bold","mb-4"],[1,"space-y-4"],["type","password","placeholder","Current Password",1,"adm-input"],["type","password","placeholder","New Password",1,"adm-input"],[1,"adm-btn","adm-btn-primary"],[1,"text-sm","text-slate-400"],[1,"flex","gap-2"],["type","password","placeholder","123456:ABC-DEF...",1,"adm-input",3,"ngModelChange","ngModel"],[1,"adm-btn","adm-btn-secondary",3,"click"],["type","text","placeholder","-100123456789",1,"adm-input",3,"ngModelChange","ngModel"],[1,"flex","items-center","gap-2","mb-2"],[1,"material-icons","text-orange-500"],["type","text",1,"adm-input",3,"ngModelChange","ngModel"],[1,"flex","justify-end"],[1,"adm-btn","adm-btn-primary","bg-orange-600","hover:bg-orange-500","border-none",3,"click"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"div")(2,"h2",1),a(3,"Settings"),t(),i(4,"p",2),a(5,"Manage your profile and system configuration."),t()(),i(6,"div",3),v(7,O,2,2,"button",4),t(),v(8,L,21,4,"div",5)(9,j,20,2,"div",5)(10,q,20,2,"div",6),t()),e&2&&(m(7),g("ngForOf",o.tabs),m(),h(o.activeTab()==="profile"?8:-1),m(),h(o.activeTab()==="notifications"?9:-1),m(),h(o.activeTab()==="security"&&o.isHypervisor()?10:-1))},dependencies:[W,U,V,B,D,G,N,F],encapsulation:2})}};export{H as SettingsComponent};
