import{d as N}from"./chunk-62QQN53Q.js";import{Aa as v,Ha as a,K as i,P as w,Sa as T,U as n,aa as s,ba as c,ca as x,e as b,f as m,i as g,ib as f,j as C,k as I,l as d,na as p,oa as y,p as S,pa as E,t as l,u as k,va as D,za as u}from"./chunk-YQLKRNON.js";var h=class o{constructor(){this.state=l(f)}checkServerHealth(){return b(fetch("/api/health")).pipe(g(e=>e.ok),I(()=>m(!1)))}checkDeviceIntegrity(){return typeof navigator>"u"?!1:navigator.webdriver?(console.warn("[Security] Automation detected via navigator.webdriver"),!1):window.screen.width===0||window.screen.height===0?(console.warn("[Security] Invalid screen dimensions detected"),!1):!0}getBrowserFingerprint(){return typeof navigator>"u"?null:{userAgent:navigator.userAgent,language:navigator.language,platform:navigator.platform,screenResolution:`${window.screen.width}x${window.screen.height}`,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,cookiesEnabled:navigator.cookieEnabled,hardwareConcurrency:navigator.hardwareConcurrency,deviceMemory:navigator.deviceMemory}}runSecurityScan(){let t=!!this.getBrowserFingerprint();return C({connection:this.checkServerHealth().pipe(d(500)),integrity:m(this.checkDeviceIntegrity()).pipe(d(800)),fingerprint:m(t).pipe(d(300))}).pipe(g(r=>r))}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275prov=S({token:o,factory:o.\u0275fac,providedIn:"root"})}};var O=class o{constructor(){this.state=l(f);this.security=l(h);this.statusMessage=w("SECURITY.VERIFYING");this.checksDone=!1;this.messagesDone=!1;this.theme=a(()=>this.state.currentFlow()?.theme);this.bgStyle=a(()=>{let e=this.theme()?.background;return e?.type==="color"?e.value:"#F5F7FA"});this.textColor=a(()=>this.theme()?.input.textColor||"#001C64");this.spinnerColor=a(()=>this.theme()?.button.background||"#003087");this.spinnerTrackColor=a(()=>this.theme()?.mode==="dark"?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.1)");this.successColor=a(()=>"#10b981")}ngOnInit(){let e=["SECURITY.VERIFYING","SECURITY.CONNECTING"],t=0;this.intervalId=setInterval(()=>{t<e.length?(this.statusMessage.set(e[t]),t++):(this.messagesDone=!0,this.tryNavigate(),clearInterval(this.intervalId))},600),this.security.runSecurityScan().subscribe({next:r=>{this.checksDone=!0,this.tryNavigate()},error:r=>{this.checksDone=!0,this.tryNavigate()}})}tryNavigate(){this.checksDone&&this.messagesDone&&(this.navTimer=setTimeout(()=>{this.state.navigate("login")},600))}ngOnDestroy(){this.intervalId&&clearInterval(this.intervalId),this.navTimer&&clearTimeout(this.navTimer)}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275cmp=k({type:o,selectors:[["app-security-check"]],standalone:!0,features:[D],decls:17,vars:23,consts:[[1,"h-screen","w-full","flex","flex-col","items-center","justify-center","font-sans","transition-colors","duration-300"],[1,"max-w-md","w-full","text-center","flex","flex-col","items-center"],[1,"relative","w-16","h-16","mb-8"],[1,"absolute","inset-0","rounded-full","border-[3px]"],[1,"absolute","inset-0","rounded-full","border-[3px]","border-l-transparent","border-r-transparent","border-b-transparent","animate-spin"],[1,"text-2xl","font-bold","mb-3","tracking-tight","animate-fade-in"],[1,"text-base","font-medium","animate-pulse","opacity-80"],[1,"mt-12","flex","items-center","gap-2","opacity-60"],[1,"material-icons","text-sm"],[1,"text-[11px]","font-bold"]],template:function(t,r){t&1&&(s(0,"div",0)(1,"div",1)(2,"div",2),x(3,"div",3)(4,"div",4),c(),s(5,"h1",5),p(6),u(7,"translate"),c(),s(8,"p",6),p(9),u(10,"translate"),c(),s(11,"div",7)(12,"span",8),p(13,"lock"),c(),s(14,"span",9),p(15),u(16,"translate"),c()()()()),t&2&&(n("background",r.bgStyle()),i(3),n("border-color",r.spinnerTrackColor()),i(),n("border-top-color",r.spinnerColor()),i(),n("color",r.textColor()),i(),E(" ",v(7,17,"SECURITY.CHECKING")," "),i(2),n("color",r.textColor()),i(),y(v(10,19,r.statusMessage())),i(3),n("color",r.successColor()),i(2),n("color",r.textColor()),i(),y(v(16,21,"COMMON.SECURE_CONNECTION")))},dependencies:[T,N],encapsulation:2})}};export{O as SecurityCheckComponent};
